<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://www.csguide.xyz/k8s/"><meta property="og:site_name" content="CSView"><meta property="og:title" content="K8S(å¾…æ•´ç†...)"><meta property="og:description" content="ä»‹ç»ä¸€ä¸‹Kubernetesï¼Ÿ Kubernetesæ˜¯ä¸€ä¸ªå…¨æ–°çš„åŸºäºå®¹å™¨æŠ€æœ¯çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ”¯æ’‘å¹³å°ã€‚æ˜¯Googleå¼€æºçš„å®¹å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿã€‚åœ¨DockeræŠ€æœ¯çš„åŸºç¡€ä¸Šï¼Œä¸ºå®¹å™¨åŒ–çš„åº”ç”¨æä¾›éƒ¨ç½²è¿è¡Œã€èµ„æºè°ƒåº¦ã€æœåŠ¡å‘ç°å’ŒåŠ¨æ€ä¼¸ç¼©ç­‰ä¸€ç³»åˆ—å®Œæ•´åŠŸèƒ½ï¼Œæé«˜äº†å¤§è§„æ¨¡å®¹å™¨é›†ç¾¤ç®¡ç†çš„ä¾¿æ·æ€§ã€‚å¹¶ä¸”å…·æœ‰å®Œå¤‡çš„é›†ç¾¤ç®¡ç†èƒ½åŠ›ï¼Œå¤šå±‚æ¬¡çš„å®‰å…¨é˜²æŠ¤å’Œå‡†å…¥æœºåˆ¶ã€å¤šç§Ÿæˆ·åº”ç”¨æ”¯æ’‘èƒ½åŠ›ã€é€æ˜çš„..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"K8S(å¾…æ•´ç†...)","image":[""],"dateModified":null,"author":[]}</script><link rel="icon" href="/logo.png"><title>K8S(å¾…æ•´ç†...) | CSView</title><meta name="description" content="ä»‹ç»ä¸€ä¸‹Kubernetesï¼Ÿ Kubernetesæ˜¯ä¸€ä¸ªå…¨æ–°çš„åŸºäºå®¹å™¨æŠ€æœ¯çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ”¯æ’‘å¹³å°ã€‚æ˜¯Googleå¼€æºçš„å®¹å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿã€‚åœ¨DockeræŠ€æœ¯çš„åŸºç¡€ä¸Šï¼Œä¸ºå®¹å™¨åŒ–çš„åº”ç”¨æä¾›éƒ¨ç½²è¿è¡Œã€èµ„æºè°ƒåº¦ã€æœåŠ¡å‘ç°å’ŒåŠ¨æ€ä¼¸ç¼©ç­‰ä¸€ç³»åˆ—å®Œæ•´åŠŸèƒ½ï¼Œæé«˜äº†å¤§è§„æ¨¡å®¹å™¨é›†ç¾¤ç®¡ç†çš„ä¾¿æ·æ€§ã€‚å¹¶ä¸”å…·æœ‰å®Œå¤‡çš„é›†ç¾¤ç®¡ç†èƒ½åŠ›ï¼Œå¤šå±‚æ¬¡çš„å®‰å…¨é˜²æŠ¤å’Œå‡†å…¥æœºåˆ¶ã€å¤šç§Ÿæˆ·åº”ç”¨æ”¯æ’‘èƒ½åŠ›ã€é€æ˜çš„...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-516c401a.css" as="style"><link rel="stylesheet" href="/assets/style-516c401a.css">
    <link rel="modulepreload" href="/assets/app-8628a663.js"><link rel="modulepreload" href="/assets/framework-edbf9e3c.js"><link rel="modulepreload" href="/assets/index.html-b9ca8a62.js"><link rel="modulepreload" href="/assets/index.html-166de38e.js"><link rel="prefetch" href="/assets/index.html-bcfa8272.js" as="script"><link rel="prefetch" href="/assets/index.html-49a1b3e3.js" as="script"><link rel="prefetch" href="/assets/array.html-31b70e1d.js" as="script"><link rel="prefetch" href="/assets/backtrack.html-cf269d55.js" as="script"><link rel="prefetch" href="/assets/dfs.html-7c4df165.js" as="script"><link rel="prefetch" href="/assets/dp.html-a6fb37f2.js" as="script"><link rel="prefetch" href="/assets/handtearing.html-b1dea35c.js" as="script"><link rel="prefetch" href="/assets/linklist.html-b91f222c.js" as="script"><link rel="prefetch" href="/assets/other.html-b173b90d.js" as="script"><link rel="prefetch" href="/assets/stark-queue.html-b17f3125.js" as="script"><link rel="prefetch" href="/assets/string.html-e40ab06f.js" as="script"><link rel="prefetch" href="/assets/tree.html-103227a5.js" as="script"><link rel="prefetch" href="/assets/index.html-4c85f2ce.js" as="script"><link rel="prefetch" href="/assets/summary.html-593a4da4.js" as="script"><link rel="prefetch" href="/assets/index.html-ec1c4b81.js" as="script"><link rel="prefetch" href="/assets/bigdata.html-95b3b1aa.js" as="script"><link rel="prefetch" href="/assets/design.html-c4fa119b.js" as="script"><link rel="prefetch" href="/assets/index.html-3a17e4a3.js" as="script"><link rel="prefetch" href="/assets/index.html-838ece45.js" as="script"><link rel="prefetch" href="/assets/gc.html-02610e6b.js" as="script"><link rel="prefetch" href="/assets/gmp.html-6e7cf69e.js" as="script"><link rel="prefetch" href="/assets/keyword.html-bb2542b6.js" as="script"><link rel="prefetch" href="/assets/summary.html-47681d07.js" as="script"><link rel="prefetch" href="/assets/index.html-29e7ffb9.js" as="script"><link rel="prefetch" href="/assets/index.html-375b5394.js" as="script"><link rel="prefetch" href="/assets/index.html-5fa54a7c.js" as="script"><link rel="prefetch" href="/assets/index.html-8f665271.js" as="script"><link rel="prefetch" href="/assets/collection.html-af6d6b7f.js" as="script"><link rel="prefetch" href="/assets/concurrent.html-48038120.js" as="script"><link rel="prefetch" href="/assets/jvm.html-ddde47c7.js" as="script"><link rel="prefetch" href="/assets/summary.html-e1f9ceb4.js" as="script"><link rel="prefetch" href="/assets/index.html-c4047705.js" as="script"><link rel="prefetch" href="/assets/engine.html-132bb6a0.js" as="script"><link rel="prefetch" href="/assets/indexing.html-88249c24.js" as="script"><link rel="prefetch" href="/assets/lock.html-48745d9b.js" as="script"><link rel="prefetch" href="/assets/log.html-4661f0d6.js" as="script"><link rel="prefetch" href="/assets/optimize.html-bac662b3.js" as="script"><link rel="prefetch" href="/assets/summary.html-93087c45.js" as="script"><link rel="prefetch" href="/assets/transaction.html-0ebc08a8.js" as="script"><link rel="prefetch" href="/assets/index.html-39818b53.js" as="script"><link rel="prefetch" href="/assets/http.html-bbf6bdc3.js" as="script"><link rel="prefetch" href="/assets/ip.html-8519aa47.js" as="script"><link rel="prefetch" href="/assets/summary.html-f1f96181.js" as="script"><link rel="prefetch" href="/assets/tcp.html-240be223.js" as="script"><link rel="prefetch" href="/assets/index.html-f09da860.js" as="script"><link rel="prefetch" href="/assets/index.html-1e0f29bb.js" as="script"><link rel="prefetch" href="/assets/index.html-8ba3ae95.js" as="script"><link rel="prefetch" href="/assets/linux.html-daca079a.js" as="script"><link rel="prefetch" href="/assets/other.html-41898388.js" as="script"><link rel="prefetch" href="/assets/process.html-511c3b52.js" as="script"><link rel="prefetch" href="/assets/summary.html-d0ea09d6.js" as="script"><link rel="prefetch" href="/assets/index.html-5929ca67.js" as="script"><link rel="prefetch" href="/assets/apply.html-38508fe8.js" as="script"><link rel="prefetch" href="/assets/summary.html-dc7e41b1.js" as="script"><link rel="prefetch" href="/assets/index.html-27bb276b.js" as="script"><link rel="prefetch" href="/assets/index.html-640ba670.js" as="script"><link rel="prefetch" href="/assets/application.html-d0b18a45.js" as="script"><link rel="prefetch" href="/assets/colony.html-bc420990.js" as="script"><link rel="prefetch" href="/assets/data-structure.html-91c4ae42.js" as="script"><link rel="prefetch" href="/assets/persistence.html-5559ec13.js" as="script"><link rel="prefetch" href="/assets/summary.html-dbab325d.js" as="script"><link rel="prefetch" href="/assets/index.html-7cf0f31d.js" as="script"><link rel="prefetch" href="/assets/interview.html-e27af118.js" as="script"><link rel="prefetch" href="/assets/resume.html-fda6b43f.js" as="script"><link rel="prefetch" href="/assets/routine.html-969bd7f9.js" as="script"><link rel="prefetch" href="/assets/index.html-e51eb259.js" as="script"><link rel="prefetch" href="/assets/404.html-44c6fef7.js" as="script"><link rel="prefetch" href="/assets/index.html-9edce8ee.js" as="script"><link rel="prefetch" href="/assets/index.html-69b29a63.js" as="script"><link rel="prefetch" href="/assets/array.html-bd6ed6ca.js" as="script"><link rel="prefetch" href="/assets/backtrack.html-2e739fb8.js" as="script"><link rel="prefetch" href="/assets/dfs.html-b04a9fd5.js" as="script"><link rel="prefetch" href="/assets/dp.html-f220b5c1.js" as="script"><link rel="prefetch" href="/assets/handtearing.html-55a32a4e.js" as="script"><link rel="prefetch" href="/assets/linklist.html-ac321bba.js" as="script"><link rel="prefetch" href="/assets/other.html-48b5f2cd.js" as="script"><link rel="prefetch" href="/assets/stark-queue.html-8d6e9c5b.js" as="script"><link rel="prefetch" href="/assets/string.html-d88cb662.js" as="script"><link rel="prefetch" href="/assets/tree.html-7c1b311e.js" as="script"><link rel="prefetch" href="/assets/index.html-a122aa71.js" as="script"><link rel="prefetch" href="/assets/summary.html-dbefdfdb.js" as="script"><link rel="prefetch" href="/assets/index.html-6640c329.js" as="script"><link rel="prefetch" href="/assets/bigdata.html-c357755f.js" as="script"><link rel="prefetch" href="/assets/design.html-70624f2a.js" as="script"><link rel="prefetch" href="/assets/index.html-8bf0a6e5.js" as="script"><link rel="prefetch" href="/assets/index.html-01e0de70.js" as="script"><link rel="prefetch" href="/assets/gc.html-74ca5048.js" as="script"><link rel="prefetch" href="/assets/gmp.html-cf48c25b.js" as="script"><link rel="prefetch" href="/assets/keyword.html-a25eab86.js" as="script"><link rel="prefetch" href="/assets/summary.html-bad54f92.js" as="script"><link rel="prefetch" href="/assets/index.html-57110532.js" as="script"><link rel="prefetch" href="/assets/index.html-0d945e7b.js" as="script"><link rel="prefetch" href="/assets/index.html-5f6cdfed.js" as="script"><link rel="prefetch" href="/assets/index.html-554d8a41.js" as="script"><link rel="prefetch" href="/assets/collection.html-ae9b298a.js" as="script"><link rel="prefetch" href="/assets/concurrent.html-47db3c69.js" as="script"><link rel="prefetch" href="/assets/jvm.html-57ebb974.js" as="script"><link rel="prefetch" href="/assets/summary.html-c0f14f23.js" as="script"><link rel="prefetch" href="/assets/index.html-4221024b.js" as="script"><link rel="prefetch" href="/assets/engine.html-8310e877.js" as="script"><link rel="prefetch" href="/assets/indexing.html-207b6d59.js" as="script"><link rel="prefetch" href="/assets/lock.html-c607ddad.js" as="script"><link rel="prefetch" href="/assets/log.html-4656fb08.js" as="script"><link rel="prefetch" href="/assets/optimize.html-20051cc7.js" as="script"><link rel="prefetch" href="/assets/summary.html-78e6d558.js" as="script"><link rel="prefetch" href="/assets/transaction.html-f9bb0289.js" as="script"><link rel="prefetch" href="/assets/index.html-c23e44b2.js" as="script"><link rel="prefetch" href="/assets/http.html-6cc0a6f8.js" as="script"><link rel="prefetch" href="/assets/ip.html-61da2abf.js" as="script"><link rel="prefetch" href="/assets/summary.html-f10878e1.js" as="script"><link rel="prefetch" href="/assets/tcp.html-3e453bb1.js" as="script"><link rel="prefetch" href="/assets/index.html-473fb5b7.js" as="script"><link rel="prefetch" href="/assets/index.html-935199e2.js" as="script"><link rel="prefetch" href="/assets/index.html-ff6498b5.js" as="script"><link rel="prefetch" href="/assets/linux.html-7f2524b4.js" as="script"><link rel="prefetch" href="/assets/other.html-83cf45cf.js" as="script"><link rel="prefetch" href="/assets/process.html-2446d169.js" as="script"><link rel="prefetch" href="/assets/summary.html-c518882e.js" as="script"><link rel="prefetch" href="/assets/index.html-f6157133.js" as="script"><link rel="prefetch" href="/assets/apply.html-830fab71.js" as="script"><link rel="prefetch" href="/assets/summary.html-d1313dac.js" as="script"><link rel="prefetch" href="/assets/index.html-7c03f1da.js" as="script"><link rel="prefetch" href="/assets/index.html-817bd582.js" as="script"><link rel="prefetch" href="/assets/application.html-4a7e143e.js" as="script"><link rel="prefetch" href="/assets/colony.html-d3562b1b.js" as="script"><link rel="prefetch" href="/assets/data-structure.html-caee799b.js" as="script"><link rel="prefetch" href="/assets/persistence.html-763a11c4.js" as="script"><link rel="prefetch" href="/assets/summary.html-8ded76f7.js" as="script"><link rel="prefetch" href="/assets/index.html-022ce469.js" as="script"><link rel="prefetch" href="/assets/interview.html-dbb96f74.js" as="script"><link rel="prefetch" href="/assets/resume.html-dc6db334.js" as="script"><link rel="prefetch" href="/assets/routine.html-c1b13210.js" as="script"><link rel="prefetch" href="/assets/index.html-00b2064f.js" as="script"><link rel="prefetch" href="/assets/404.html-529fb7bf.js" as="script"><link rel="prefetch" href="/assets/waline-meta-a31b78ed.js" as="script"><link rel="prefetch" href="/assets/component-7ab2cb70.js" as="script"><link rel="prefetch" href="/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/assets/index-8764208e.js" as="script"><link rel="prefetch" href="/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/assets/mermaid.esm.min-6068c030.js" as="script"><link rel="prefetch" href="/assets/mermaid-mindmap.esm.min-4cfaa638.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-a794bb63.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-d92a2fc9.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-224f94d9.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-e5069ce0.js" as="script"><link rel="prefetch" href="/assets/search.esm-2c3fba7d.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-10aa7bee.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-04fddac6.js" as="script"><link rel="prefetch" href="/assets/SearchResult-56b057c4.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo light" src="/logo.png" alt="CSView"><img class="logo dark" src="/logodark.png" alt="CSView"><span class="site-name hide-in-pad">CSView</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="é¢è¯•å¿…åˆ·ç®—æ³•"><span class="title"><span class="font-icon icon iconfont icon-suanfaku" style=""></span>é¢è¯•å¿…åˆ·ç®—æ³•</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/algorithm-mandatory/" class="nav-link" aria-label="å¿…åˆ·ç®—æ³•100é¢˜"><span class="font-icon icon iconfont icon-zhongdianbiaozhu" style=""></span>å¿…åˆ·ç®—æ³•100é¢˜<!----></a></li><li class="dropdown-item"><a href="/intelligence/" class="nav-link" aria-label="æ™ºåŠ›é¢˜"><span class="font-icon icon iconfont icon-dengpao" style=""></span>æ™ºåŠ›é¢˜<!----></a></li><li class="dropdown-item"><a href="/design/" class="nav-link" aria-label="è®¾è®¡é¢˜"><span class="font-icon icon iconfont icon-sheji-xianxing" style=""></span>è®¾è®¡é¢˜<!----></a></li><li class="dropdown-item"><a href="/hr/" class="nav-link" aria-label="HRé¢å¸¸è§é¢˜"><span class="font-icon icon iconfont icon-mianshianpai" style=""></span>HRé¢å¸¸è§é¢˜<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/network/" class="nav-link" aria-label="è®¡ç®—æœºç½‘ç»œ"><span class="font-icon icon iconfont icon-wangluo1" style=""></span>è®¡ç®—æœºç½‘ç»œ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/os/" class="nav-link" aria-label="æ“ä½œç³»ç»Ÿ"><span class="font-icon icon iconfont icon-caozuoxitong" style=""></span>æ“ä½œç³»ç»Ÿ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ•°æ®åº“"><span class="title"><span class="font-icon icon iconfont icon-data-Inquire-full" style=""></span>æ•°æ®åº“</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/mysql/" class="nav-link" aria-label="MySQL"><span class="font-icon icon iconfont icon-odbc-full" style=""></span>MySQL<!----></a></li><li class="dropdown-item"><a href="/redis/" class="nav-link" aria-label="Redis"><span class="font-icon icon iconfont icon-redis" style=""></span>Redis<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç¼–ç¨‹è¯­è¨€åŸºç¡€"><span class="title"><span class="font-icon icon iconfont icon-biancheng-01" style=""></span>ç¼–ç¨‹è¯­è¨€åŸºç¡€</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/golang/" class="nav-link" aria-label="golang"><span class="font-icon icon iconfont icon-Goyuyan" style=""></span>golang<!----></a></li><li class="dropdown-item"><a href="/cpp/" class="nav-link" aria-label="c++"><span class="font-icon icon iconfont icon-cyuyan" style=""></span>c++<!----></a></li><li class="dropdown-item"><a href="/java/" class="nav-link" aria-label="java"><span class="font-icon icon iconfont icon-java" style=""></span>java<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ä¸­é—´ä»¶"><span class="title"><span class="font-icon icon iconfont icon-gongju" style=""></span>ä¸­é—´ä»¶</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/rabbitmq/" class="nav-link" aria-label="RabbitMQ"><span class="font-icon icon iconfont icon-RabbitMQ" style=""></span>RabbitMQ<!----></a></li><li class="dropdown-item"><a href="/nginx/" class="nav-link" aria-label="Nginx"><span class="font-icon icon iconfont icon-nginx" style=""></span>Nginx<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/k8s/" class="router-link-active router-link-exact-active nav-link active" aria-label="Kubernetes"><span class="font-icon icon iconfont icon-kubernetes" style=""></span>Kubernetes<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ‹›è˜æŠ•é€’ç½‘å€"><span class="title"><span class="font-icon icon iconfont icon-zhaopin" style=""></span>æ‹›è˜æŠ•é€’ç½‘å€</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/offical-delivery/" class="nav-link" aria-label="å®˜æ–¹ç½‘å€"><span class="font-icon icon iconfont icon-qidongzhaopinguanli" style=""></span>å®˜æ–¹ç½‘å€<!----></a></li><li class="dropdown-item"><a href="/recommendation-delivery/" class="nav-link" aria-label="å†…æ¨ä¿¡æ¯"><span class="font-icon icon iconfont icon-qidongzhaopinshenpi" style=""></span>å†…æ¨ä¿¡æ¯<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å…³äºæœ¬ç«™"><span class="title"><span class="font-icon icon iconfont icon-guanyu" style=""></span>å…³äºæœ¬ç«™</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/development-log" class="nav-link" aria-label="å¼€å‘æ—¥å¿—"><span class="font-icon icon iconfont icon-rizhi" style=""></span>å¼€å‘æ—¥å¿—<!----></a></li><li class="dropdown-item"><a href="/website-contribution" class="nav-link" aria-label="ç½‘ç«™è´¡çŒ®"><span class="font-icon icon iconfont icon-gongxian" style=""></span>ç½‘ç«™è´¡çŒ®<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/zijing2333/CSGuide" target="_blank" rel="noopener noreferrer" aria-label="GitHubä»“åº“"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">æœç´¢</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-suanfaku" style=""></span><span class="title">åˆ·é¢˜</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/algorithm-mandatory" class="nav-link sidebar-link sidebar-page" aria-label="é¢è¯•å¿…åˆ·ç®—æ³•é¢˜"><span class="font-icon icon iconfont icon-zhongdianbiaozhu" style=""></span>é¢è¯•å¿…åˆ·ç®—æ³•é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/intelligence" class="nav-link sidebar-link sidebar-page" aria-label="æ™ºåŠ›é¢˜"><span class="font-icon icon iconfont icon-dengpao" style=""></span>æ™ºåŠ›é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/design" class="nav-link sidebar-link sidebar-page" aria-label="è®¾è®¡é¢˜"><span class="font-icon icon iconfont icon-sheji-xianxing" style=""></span>è®¾è®¡é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/hr" class="nav-link sidebar-link sidebar-page" aria-label="HRé¢å¸¸è§é¢˜"><span class="font-icon icon iconfont icon-mianshianpai" style=""></span>HRé¢å¸¸è§é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><!--[--><a href="/os" class="nav-link sidebar-link sidebar-page" aria-label="æ“ä½œç³»ç»Ÿ"><span class="font-icon icon iconfont icon-caozuoxitong" style=""></span>æ“ä½œç³»ç»Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-data-Inquire-full" style=""></span><span class="title">æ•°æ®åº“</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/mysql" class="nav-link sidebar-link sidebar-page" aria-label="MySQL"><span class="font-icon icon iconfont icon-odbc-full" style=""></span>MySQL<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/redis" class="nav-link sidebar-link sidebar-page" aria-label="Redis"><span class="font-icon icon iconfont icon-redis" style=""></span>Redis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-biancheng-01" style=""></span><span class="title">ç¼–ç¨‹è¯­è¨€åŸºç¡€</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/golang" class="nav-link sidebar-link sidebar-page" aria-label="golang"><span class="font-icon icon iconfont icon-Goyuyan" style=""></span>golang<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cpp" class="nav-link sidebar-link sidebar-page" aria-label="c++"><span class="font-icon icon iconfont icon-cyuyan" style=""></span>c++<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java" class="nav-link sidebar-link sidebar-page" aria-label="java"><span class="font-icon icon iconfont icon-java" style=""></span>java<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-gongju" style=""></span><span class="title">ä¸­é—´ä»¶</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/rabbitmq" class="nav-link sidebar-link sidebar-page" aria-label="RabbitMQ"><span class="font-icon icon iconfont icon-RabbitMQ" style=""></span>RabbitMQ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/nginx" class="nav-link sidebar-link sidebar-page" aria-label="Nginx"><span class="font-icon icon iconfont icon-nginx" style=""></span>Nginx<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/k8s" class="router-link-active router-link-exact-active nav-link sidebar-link sidebar-page" aria-label="Kubernetes"><span class="font-icon icon iconfont icon-kubernetes" style=""></span>Kubernetes<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->K8S(å¾…æ•´ç†...)</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">zijing2333</span></span><span property="author" content="zijing2333"></span></span><!----><!----><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" id="ArtalkPV" data-path="/k8s/">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 39 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT39M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#ä»‹ç»ä¸€ä¸‹kubernetes" class="router-link-active router-link-exact-active toc-link level3">ä»‹ç»ä¸€ä¸‹Kubernetesï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#etcdåŠå…¶ç‰¹ç‚¹" class="router-link-active router-link-exact-active toc-link level3">ETCDåŠå…¶ç‰¹ç‚¹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kuberneteså’Œdockerçš„å…³ç³»" class="router-link-active router-link-exact-active toc-link level3">Kuberneteså’ŒDockerçš„å…³ç³»ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesä¸­ä»€ä¹ˆæ˜¯minikubeã€kubectlã€kubelet" class="router-link-active router-link-exact-active toc-link level3">Kubernetesä¸­ä»€ä¹ˆæ˜¯Minikubeã€Kubectlã€Kubeletï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesçš„éƒ¨ç½²æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">Kubernetesçš„éƒ¨ç½²æ–¹å¼ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kuberneteså¦‚ä½•å®ç°é›†ç¾¤ç®¡ç†" class="router-link-active router-link-exact-active toc-link level3">Kuberneteså¦‚ä½•å®ç°é›†ç¾¤ç®¡ç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesçš„ä¼˜åŠ¿ã€é€‚åº”åœºæ™¯åŠå…¶ç‰¹ç‚¹" class="router-link-active router-link-exact-active toc-link level3">Kubernetesçš„ä¼˜åŠ¿ã€é€‚åº”åœºæ™¯åŠå…¶ç‰¹ç‚¹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesç›¸å…³åŸºç¡€æ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level3">Kubernetesç›¸å…³åŸºç¡€æ¦‚å¿µï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesé›†ç¾¤ç›¸å…³ç»„ä»¶" class="router-link-active router-link-exact-active toc-link level3">Kubernetesé›†ç¾¤ç›¸å…³ç»„ä»¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-rcçš„æœºåˆ¶" class="router-link-active router-link-exact-active toc-link level3">Kubernetes RCçš„æœºåˆ¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-replica-set-å’Œ-replication-controller-ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Replica Set å’Œ Replication Controller ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kube-proxyä½œç”¨" class="router-link-active router-link-exact-active toc-link level3">kube-proxyä½œç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kube-proxy-iptablesåŸç†" class="router-link-active router-link-exact-active toc-link level3">kube-proxy iptablesåŸç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kube-proxy-ipvsåŸç†" class="router-link-active router-link-exact-active toc-link level3">kube-proxy ipvsåŸç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kube-proxy-ipvså’Œiptablesçš„å¼‚åŒ" class="router-link-active router-link-exact-active toc-link level3">kube-proxy ipvså’Œiptablesçš„å¼‚åŒï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesä¸­ä»€ä¹ˆæ˜¯é™æ€pod" class="router-link-active router-link-exact-active toc-link level3">Kubernetesä¸­ä»€ä¹ˆæ˜¯é™æ€Podï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesä¸­podå¯èƒ½ä½äºçš„çŠ¶æ€" class="router-link-active router-link-exact-active toc-link level3">Kubernetesä¸­Podå¯èƒ½ä½äºçš„çŠ¶æ€ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesåˆ›å»ºä¸€ä¸ªpodçš„ä¸»è¦æµç¨‹" class="router-link-active router-link-exact-active toc-link level3">Kubernetesåˆ›å»ºä¸€ä¸ªPodçš„ä¸»è¦æµç¨‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesä¸­podçš„é‡å¯ç­–ç•¥" class="router-link-active router-link-exact-active toc-link level3">Kubernetesä¸­Podçš„é‡å¯ç­–ç•¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesä¸­podçš„å¥åº·æ£€æŸ¥æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">Kubernetesä¸­Podçš„å¥åº·æ£€æŸ¥æ–¹å¼ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-podçš„livenessprobeæ¢é’ˆçš„å¸¸è§æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Podçš„LivenessProbeæ¢é’ˆçš„å¸¸è§æ–¹å¼ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-podçš„å¸¸è§è°ƒåº¦æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Podçš„å¸¸è§è°ƒåº¦æ–¹å¼ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesåˆå§‹åŒ–å®¹å™¨-init-container" class="router-link-active router-link-exact-active toc-link level3">Kubernetesåˆå§‹åŒ–å®¹å™¨(init containerï¼‰ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-deploymentå‡çº§è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">Kubernetes deploymentå‡çº§è¿‡ç¨‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-deploymentå‡çº§ç­–ç•¥" class="router-link-active router-link-exact-active toc-link level3">Kubernetes deploymentå‡çº§ç­–ç•¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-daemonsetç±»å‹çš„èµ„æºç‰¹æ€§" class="router-link-active router-link-exact-active toc-link level3">Kubernetes DaemonSetç±»å‹çš„èµ„æºç‰¹æ€§ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesè‡ªåŠ¨æ‰©å®¹æœºåˆ¶" class="router-link-active router-link-exact-active toc-link level3">Kubernetesè‡ªåŠ¨æ‰©å®¹æœºåˆ¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-serviceç±»å‹" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Serviceç±»å‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-serviceåˆ†å‘åç«¯çš„ç­–ç•¥" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Serviceåˆ†å‘åç«¯çš„ç­–ç•¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-headless-service" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Headless Serviceï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kuberneteså¤–éƒ¨å¦‚ä½•è®¿é—®é›†ç¾¤å†…çš„æœåŠ¡" class="router-link-active router-link-exact-active toc-link level3">Kuberneteså¤–éƒ¨å¦‚ä½•è®¿é—®é›†ç¾¤å†…çš„æœåŠ¡ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-ingress" class="router-link-active router-link-exact-active toc-link level3">Kubernetes ingressï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesçš„è´Ÿè½½å‡è¡¡å™¨" class="router-link-active router-link-exact-active toc-link level3">Kubernetesçš„è´Ÿè½½å‡è¡¡å™¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kuberneteså„æ¨¡å—å¦‚ä½•ä¸api-serveré€šä¿¡" class="router-link-active router-link-exact-active toc-link level3">Kuberneteså„æ¨¡å—å¦‚ä½•ä¸API Serveré€šä¿¡ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-schedulerä½œç”¨åŠå®ç°åŸç†" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Schedulerä½œç”¨åŠå®ç°åŸç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-schedulerä½¿ç”¨å“ªä¸¤ç§ç®—æ³•å°†podç»‘å®šåˆ°workerèŠ‚ç‚¹" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Schedulerä½¿ç”¨å“ªä¸¤ç§ç®—æ³•å°†Podç»‘å®šåˆ°workerèŠ‚ç‚¹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-kubeletçš„ä½œç”¨" class="router-link-active router-link-exact-active toc-link level3">Kubernetes kubeletçš„ä½œç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-kubeletç›‘æ§workerèŠ‚ç‚¹èµ„æºæ˜¯ä½¿ç”¨ä»€ä¹ˆç»„ä»¶æ¥å®ç°çš„" class="router-link-active router-link-exact-active toc-link level3">Kubernetes kubeletç›‘æ§WorkerèŠ‚ç‚¹èµ„æºæ˜¯ä½¿ç”¨ä»€ä¹ˆç»„ä»¶æ¥å®ç°çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kuberneteså¦‚ä½•ä¿è¯é›†ç¾¤çš„å®‰å…¨æ€§" class="router-link-active router-link-exact-active toc-link level3">Kuberneteså¦‚ä½•ä¿è¯é›†ç¾¤çš„å®‰å…¨æ€§ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kuberneteså‡†å…¥æœºåˆ¶" class="router-link-active router-link-exact-active toc-link level3">Kuberneteså‡†å…¥æœºåˆ¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-rbacåŠå…¶ç‰¹ç‚¹-ä¼˜åŠ¿" class="router-link-active router-link-exact-active toc-link level3">Kubernetes RBACåŠå…¶ç‰¹ç‚¹(ä¼˜åŠ¿ï¼‰ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-secretä½œç”¨" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Secretä½œç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-secretæœ‰å“ªäº›ä½¿ç”¨æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Secretæœ‰å“ªäº›ä½¿ç”¨æ–¹å¼ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-podsecuritypolicyæœºåˆ¶" class="router-link-active router-link-exact-active toc-link level3">Kubernetes PodSecurityPolicyæœºåˆ¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-podsecuritypolicyæœºåˆ¶èƒ½å®ç°å“ªäº›å®‰å…¨ç­–ç•¥" class="router-link-active router-link-exact-active toc-link level3">Kubernetes PodSecurityPolicyæœºåˆ¶èƒ½å®ç°å“ªäº›å®‰å…¨ç­–ç•¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesç½‘ç»œæ¨¡å‹" class="router-link-active router-link-exact-active toc-link level3">Kubernetesç½‘ç»œæ¨¡å‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-cniæ¨¡å‹" class="router-link-active router-link-exact-active toc-link level3">Kubernetes CNIæ¨¡å‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesç½‘ç»œç­–ç•¥" class="router-link-active router-link-exact-active toc-link level3">Kubernetesç½‘ç»œç­–ç•¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesç½‘ç»œç­–ç•¥åŸç†" class="router-link-active router-link-exact-active toc-link level3">Kubernetesç½‘ç»œç­–ç•¥åŸç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesä¸­flannelçš„ä½œç”¨" class="router-link-active router-link-exact-active toc-link level3">Kubernetesä¸­flannelçš„ä½œç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kuberneteså…±äº«å­˜å‚¨çš„ä½œç”¨" class="router-link-active router-link-exact-active toc-link level3">Kuberneteså…±äº«å­˜å‚¨çš„ä½œç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesæ•°æ®æŒä¹…åŒ–çš„æ–¹å¼æœ‰å“ªäº›" class="router-link-active router-link-exact-active toc-link level3">Kubernetesæ•°æ®æŒä¹…åŒ–çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-pvå’Œpvc" class="router-link-active router-link-exact-active toc-link level3">Kubernetes PVå’ŒPVCï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-pvç”Ÿå‘½å‘¨æœŸå†…çš„é˜¶æ®µ" class="router-link-active router-link-exact-active toc-link level3">Kubernetes PVç”Ÿå‘½å‘¨æœŸå†…çš„é˜¶æ®µï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesæ‰€æ”¯æŒçš„å­˜å‚¨ä¾›åº”æ¨¡å¼" class="router-link-active router-link-exact-active toc-link level3">Kubernetesæ‰€æ”¯æŒçš„å­˜å‚¨ä¾›åº”æ¨¡å¼ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-csiæ¨¡å‹" class="router-link-active router-link-exact-active toc-link level3">Kubernetes CSIæ¨¡å‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-workerèŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">Kubernetes WorkerèŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„è¿‡ç¨‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-podå¦‚ä½•å®ç°å¯¹èŠ‚ç‚¹çš„èµ„æºæ§åˆ¶" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Podå¦‚ä½•å®ç°å¯¹èŠ‚ç‚¹çš„èµ„æºæ§åˆ¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-requestså’Œlimitså¦‚ä½•å½±å“podçš„è°ƒåº¦" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Requestså’ŒLimitså¦‚ä½•å½±å“Podçš„è°ƒåº¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetes-metric-service" class="router-link-active router-link-exact-active toc-link level3">Kubernetes Metric Serviceï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesä¸­-å¦‚ä½•ä½¿ç”¨efkå®ç°æ—¥å¿—çš„ç»Ÿä¸€ç®¡ç†" class="router-link-active router-link-exact-active toc-link level3">Kubernetesä¸­ï¼Œå¦‚ä½•ä½¿ç”¨EFKå®ç°æ—¥å¿—çš„ç»Ÿä¸€ç®¡ç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kuberneteså¦‚ä½•è¿›è¡Œä¼˜é›…çš„èŠ‚ç‚¹å…³æœºç»´æŠ¤" class="router-link-active router-link-exact-active toc-link level3">Kuberneteså¦‚ä½•è¿›è¡Œä¼˜é›…çš„èŠ‚ç‚¹å…³æœºç»´æŠ¤ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#kubernetesé›†ç¾¤è”é‚¦" class="router-link-active router-link-exact-active toc-link level3">Kubernetesé›†ç¾¤è”é‚¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/k8s/#helmåŠå…¶ä¼˜åŠ¿" class="router-link-active router-link-exact-active toc-link level3">HelmåŠå…¶ä¼˜åŠ¿ï¼Ÿ</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h3 id="ä»‹ç»ä¸€ä¸‹kubernetes" tabindex="-1"><a class="header-anchor" href="#ä»‹ç»ä¸€ä¸‹kubernetes" aria-hidden="true">#</a> ä»‹ç»ä¸€ä¸‹Kubernetesï¼Ÿ</h3><p>Kubernetesæ˜¯ä¸€ä¸ªå…¨æ–°çš„åŸºäºå®¹å™¨æŠ€æœ¯çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ”¯æ’‘å¹³å°ã€‚æ˜¯Googleå¼€æºçš„å®¹å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿã€‚åœ¨DockeræŠ€æœ¯çš„åŸºç¡€ä¸Šï¼Œä¸ºå®¹å™¨åŒ–çš„åº”ç”¨æä¾›éƒ¨ç½²è¿è¡Œã€èµ„æºè°ƒåº¦ã€æœåŠ¡å‘ç°å’ŒåŠ¨æ€ä¼¸ç¼©ç­‰ä¸€ç³»åˆ—å®Œæ•´åŠŸèƒ½ï¼Œæé«˜äº†å¤§è§„æ¨¡å®¹å™¨é›†ç¾¤ç®¡ç†çš„ä¾¿æ·æ€§ã€‚å¹¶ä¸”å…·æœ‰å®Œå¤‡çš„é›†ç¾¤ç®¡ç†èƒ½åŠ›ï¼Œå¤šå±‚æ¬¡çš„å®‰å…¨é˜²æŠ¤å’Œå‡†å…¥æœºåˆ¶ã€å¤šç§Ÿæˆ·åº”ç”¨æ”¯æ’‘èƒ½åŠ›ã€é€æ˜çš„æœåŠ¡æ³¨å†Œå’Œå‘ç°æœºåˆ¶ã€å†…å»ºæ™ºèƒ½è´Ÿè½½å‡è¡¡å™¨ã€å¼ºå¤§çš„æ•…éšœå‘ç°å’Œè‡ªæˆ‘ä¿®å¤èƒ½åŠ›ã€æœåŠ¡æ»šåŠ¨å‡çº§å’Œåœ¨çº¿æ‰©å®¹èƒ½åŠ›ã€å¯æ‰©å±•çš„èµ„æºè‡ªåŠ¨è°ƒåº¦æœºåˆ¶ä»¥åŠå¤šç²’åº¦çš„èµ„æºé…é¢ç®¡ç†èƒ½åŠ›ã€‚</p><h3 id="etcdåŠå…¶ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#etcdåŠå…¶ç‰¹ç‚¹" aria-hidden="true">#</a> ETCDåŠå…¶ç‰¹ç‚¹ï¼Ÿ</h3><p>ETCDæ˜¯ä¸€ä¸ªç®¡ç†é…ç½®ä¿¡æ¯å’ŒæœåŠ¡å‘ç°çš„é¡¹ç›®ï¼Œ å®ƒçš„ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªé«˜å¯ç”¨çš„åˆ†å¸ƒå¼é”®å€¼æ•°æ®åº“ï¼ŒåŸºäºGoè¯­è¨€å®ç°ã€‚</p><p><strong>ç‰¹ç‚¹</strong></p><ul><li><p>ç®€å•ï¼šæ”¯æŒ REST é£æ ¼çš„ HTTP+JSON API</p></li><li><p>å®‰å…¨ï¼šæ”¯æŒ HTTPS æ–¹å¼çš„è®¿é—®å¿«é€Ÿï¼šæ”¯æŒå¹¶å‘ 1k/s çš„å†™æ“ä½œ</p></li><li><p>å¯é ï¼šæ”¯æŒåˆ†å¸ƒå¼ç»“æ„ï¼ŒåŸºäº Raft çš„ä¸€è‡´æ€§ç®—æ³•ï¼ŒRaft æ˜¯ä¸€å¥—é€šè¿‡é€‰ä¸¾ä¸»èŠ‚ç‚¹æ¥å®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸€è‡´æ€§çš„ç®—æ³•</p></li></ul><p><strong>åº”ç”¨åœºæ™¯</strong></p><ul><li><strong>æœåŠ¡å‘ç°</strong>ï¼šæœåŠ¡å‘ç°ä¸»è¦è§£å†³åœ¨åŒä¸€ä¸ªåˆ†å¸ƒå¼é›†ç¾¤ä¸­çš„è¿›ç¨‹æˆ–æœåŠ¡ï¼Œè¦å¦‚ä½•æ‰èƒ½æ‰¾åˆ°å¯¹æ–¹å¹¶å»ºç«‹è¿æ¥ã€‚æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒæœåŠ¡å‘ç°å°±æ˜¯æƒ³è¦äº†è§£é›†ç¾¤ä¸­æ˜¯å¦æœ‰è¿›ç¨‹åœ¨ç›‘å¬UDPæˆ–TCPç«¯å£ï¼Œå¹¶ä¸”é€šè¿‡åå­—å°±å¯ä»¥æŸ¥æ‰¾å’Œè¿æ¥ã€‚</li><li><strong>æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…</strong>ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ€é€‚ç”¨çš„ä¸€ç§ç»„ä»¶é—´é€šä¿¡æ–¹å¼å°±æ˜¯æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…ã€‚å³æ„å»ºä¸€ä¸ªé…ç½®å…±äº«ä¸­å¿ƒï¼Œæ•°æ®æä¾›è€…åœ¨è¿™ä¸ªé…ç½®ä¸­å¿ƒå‘å¸ƒæ¶ˆæ¯ï¼Œè€Œæ¶ˆæ¯ä½¿ç”¨è€…åˆ™è®¢é˜…ä»–ä»¬å…³å¿ƒçš„ä¸»é¢˜ï¼Œä¸€æ—¦ä¸»é¢˜æœ‰æ¶ˆæ¯å‘å¸ƒï¼Œå°±ä¼šå®æ—¶é€šçŸ¥è®¢é˜…è€…ã€‚é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥åšåˆ°åˆ†å¸ƒå¼ç³»ç»Ÿé…ç½®çš„é›†ä¸­å¼ç®¡ç†ä¸åŠ¨æ€æ›´æ–°ã€‚åº”ç”¨ä¸­ç”¨åˆ°çš„ä¸€äº›é…ç½®ä¿¡æ¯æ”¾åˆ°ETCDä¸Šè¿›è¡Œé›†ä¸­ç®¡ç†ã€‚</li><li><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸ºäº†ä¿è¯æœåŠ¡çš„é«˜å¯ç”¨ä»¥åŠæ•°æ®çš„ä¸€è‡´æ€§ï¼Œé€šå¸¸éƒ½ä¼šæŠŠæ•°æ®å’ŒæœåŠ¡éƒ¨ç½²å¤šä»½ï¼Œä»¥æ­¤è¾¾åˆ°å¯¹ç­‰æœåŠ¡ï¼Œå³ä½¿å…¶ä¸­çš„æŸä¸€ä¸ªæœåŠ¡å¤±æ•ˆäº†ï¼Œä¹Ÿä¸å½±å“ä½¿ç”¨ã€‚ETCDæœ¬èº«åˆ†å¸ƒå¼æ¶æ„å­˜å‚¨çš„ä¿¡æ¯è®¿é—®æ”¯æŒè´Ÿè½½å‡è¡¡ã€‚ETCDé›†ç¾¤åŒ–ä»¥åï¼Œæ¯ä¸ªETCDçš„æ ¸å¿ƒèŠ‚ç‚¹éƒ½å¯ä»¥å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ã€‚æ‰€ä»¥ï¼ŒæŠŠæ•°æ®é‡å°ä½†æ˜¯è®¿é—®é¢‘ç¹çš„æ¶ˆæ¯æ•°æ®ç›´æ¥å­˜å‚¨åˆ°ETCDä¸­ä¹Ÿå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡çš„æ•ˆæœã€‚</li><li><strong>åˆ†å¸ƒå¼é€šçŸ¥ä¸åè°ƒ</strong>ï¼šä¸æ¶ˆæ¯å‘å¸ƒå’Œè®¢é˜…ç±»ä¼¼ï¼Œéƒ½ç”¨åˆ°äº†ETCDä¸­çš„Watcheræœºåˆ¶ï¼Œé€šè¿‡æ³¨å†Œä¸å¼‚æ­¥é€šçŸ¥æœºåˆ¶ï¼Œå®ç°åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ä¸åŒç³»ç»Ÿä¹‹é—´çš„é€šçŸ¥ä¸åè°ƒï¼Œä»è€Œå¯¹æ•°æ®å˜æ›´åšåˆ°å®æ—¶å¤„ç†ã€‚</li><li><strong>åˆ†å¸ƒå¼é”</strong>ï¼šå› ä¸ºETCDä½¿ç”¨Raftç®—æ³•ä¿æŒäº†æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼ŒæŸæ¬¡æ“ä½œå­˜å‚¨åˆ°é›†ç¾¤ä¸­çš„å€¼å¿…ç„¶æ˜¯å…¨å±€ä¸€è‡´çš„ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å®ç°åˆ†å¸ƒå¼é”ã€‚é”æœåŠ¡æœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼Œä¸€æ˜¯ä¿æŒç‹¬å ï¼ŒäºŒæ˜¯æ§åˆ¶æ—¶åºã€‚</li><li><strong>é›†ç¾¤ç›‘æ§ä¸Leaderç«é€‰</strong>ï¼šé€šè¿‡ETCDæ¥è¿›è¡Œç›‘æ§å®ç°èµ·æ¥éå¸¸ç®€å•å¹¶ä¸”å®æ—¶æ€§å¼ºã€‚</li></ul><h3 id="kuberneteså’Œdockerçš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#kuberneteså’Œdockerçš„å…³ç³»" aria-hidden="true">#</a> Kuberneteså’ŒDockerçš„å…³ç³»ï¼Ÿ</h3><p>Dockeræä¾›å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œï¼ŒDockeré•œåƒæ„å»ºè¿è¡Œæ—¶å®¹å™¨ã€‚å®ƒçš„ä¸»è¦ä¼˜ç‚¹æ˜¯å°†è½¯ä»¶/åº”ç”¨ç¨‹åºè¿è¡Œæ‰€éœ€çš„è®¾ç½®å’Œä¾èµ–é¡¹æ‰“åŒ…åˆ°ä¸€ä¸ªå®¹å™¨ä¸­ï¼Œä»è€Œå®ç°äº†å¯ç§»æ¤æ€§ç­‰ä¼˜ç‚¹ã€‚</p><p>Kubernetesç”¨äºå…³è”å’Œç¼–æ’åœ¨å¤šä¸ªä¸»æœºä¸Šè¿è¡Œçš„å®¹å™¨ã€‚</p><h3 id="kubernetesä¸­ä»€ä¹ˆæ˜¯minikubeã€kubectlã€kubelet" tabindex="-1"><a class="header-anchor" href="#kubernetesä¸­ä»€ä¹ˆæ˜¯minikubeã€kubectlã€kubelet" aria-hidden="true">#</a> Kubernetesä¸­ä»€ä¹ˆæ˜¯Minikubeã€Kubectlã€Kubeletï¼Ÿ</h3><p>Minikubeæ˜¯ä¸€ç§å¯ä»¥åœ¨æœ¬åœ°è½»æ¾è¿è¡Œä¸€ä¸ªå•èŠ‚ç‚¹Kubernetesç¾¤é›†çš„å·¥å…·ã€‚</p><p>Kubectlæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨è¯¥å·¥å…·æ§åˆ¶Kubernetesé›†ç¾¤ç®¡ç†å™¨ï¼Œå¦‚æ£€æŸ¥ç¾¤é›†èµ„æºï¼Œåˆ›å»ºã€åˆ é™¤å’Œæ›´æ–°ç»„ä»¶ï¼ŒæŸ¥çœ‹åº”ç”¨ç¨‹åºã€‚</p><p>Kubeletæ˜¯ä¸€ä¸ªä»£ç†æœåŠ¡ï¼Œå®ƒåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œå¹¶ä½¿ä»æœåŠ¡å™¨ä¸ä¸»æœåŠ¡å™¨é€šä¿¡ã€‚</p><h3 id="kubernetesçš„éƒ¨ç½²æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#kubernetesçš„éƒ¨ç½²æ–¹å¼" aria-hidden="true">#</a> Kubernetesçš„éƒ¨ç½²æ–¹å¼ï¼Ÿ</h3><p>å¸¸è§çš„Kuberneteséƒ¨ç½²æ–¹å¼æœ‰ï¼škubeadmï¼šä¹Ÿæ˜¯æ¨èçš„ä¸€ç§éƒ¨ç½²æ–¹å¼ï¼›äºŒè¿›åˆ¶ã€‚</p><h3 id="kuberneteså¦‚ä½•å®ç°é›†ç¾¤ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#kuberneteså¦‚ä½•å®ç°é›†ç¾¤ç®¡ç†" aria-hidden="true">#</a> Kuberneteså¦‚ä½•å®ç°é›†ç¾¤ç®¡ç†ï¼Ÿ</h3><p>Kuberneteså°†é›†ç¾¤ä¸­çš„æœºå™¨åˆ’åˆ†ä¸ºä¸€ä¸ªMasterèŠ‚ç‚¹å’Œä¸€ç¾¤å·¥ä½œèŠ‚ç‚¹Nodeã€‚å…¶ä¸­ï¼Œåœ¨MasterèŠ‚ç‚¹è¿è¡Œç€é›†ç¾¤ç®¡ç†ç›¸å…³çš„ä¸€ç»„è¿›ç¨‹kube-apiserverã€kube-controller-managerå’Œkube- schedulerï¼Œè¿™äº›è¿›ç¨‹å®ç°äº†æ•´ä¸ªé›†ç¾¤çš„èµ„æºç®¡ç†ã€Podè°ƒåº¦ã€å¼¹æ€§ä¼¸ç¼©ã€å®‰å…¨æ§åˆ¶ã€ç³»ç»Ÿç›‘æ§å’Œçº é”™ç­‰ç®¡ç†èƒ½åŠ›ï¼Œå¹¶ä¸”éƒ½æ˜¯å…¨è‡ªåŠ¨å®Œæˆçš„ã€‚</p><h3 id="kubernetesçš„ä¼˜åŠ¿ã€é€‚åº”åœºæ™¯åŠå…¶ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#kubernetesçš„ä¼˜åŠ¿ã€é€‚åº”åœºæ™¯åŠå…¶ç‰¹ç‚¹" aria-hidden="true">#</a> Kubernetesçš„ä¼˜åŠ¿ã€é€‚åº”åœºæ™¯åŠå…¶ç‰¹ç‚¹ï¼Ÿ</h3><p><strong>ä¼˜åŠ¿</strong></p><ul><li><p>å®¹å™¨ç¼–æ’è½»é‡çº§å¼€æº</p></li><li><p>å¼¹æ€§ä¼¸ç¼©è´Ÿè½½å‡è¡¡</p></li></ul><p><strong>å¸¸è§åœºæ™¯</strong></p><ul><li><p>å¿«é€Ÿéƒ¨ç½²åº”ç”¨å¿«é€Ÿæ‰©å±•åº”ç”¨</p></li><li><p>æ— ç¼å¯¹æ¥æ–°çš„åº”ç”¨åŠŸèƒ½</p></li><li><p>èŠ‚çœèµ„æºï¼Œä¼˜åŒ–ç¡¬ä»¶èµ„æºçš„ä½¿ç”¨</p></li></ul><p><strong>ç‰¹ç‚¹</strong></p><ul><li><p>å¯ç§»æ¤ï¼šæ”¯æŒå…¬æœ‰äº‘ã€ç§æœ‰äº‘ã€æ··åˆäº‘ã€å¤šé‡äº‘(multi-cloudï¼‰</p></li><li><p>å¯æ‰©å±•ï¼šæ¨¡å—åŒ–,ã€æ’ä»¶åŒ–ã€å¯æŒ‚è½½ã€å¯ç»„åˆã€‚</p></li><li><p>è‡ªåŠ¨åŒ–ï¼šè‡ªåŠ¨éƒ¨ç½²ã€è‡ªåŠ¨é‡å¯ã€è‡ªåŠ¨å¤åˆ¶ã€è‡ªåŠ¨ä¼¸ç¼©/æ‰©å±•</p></li></ul><h3 id="kubernetesç›¸å…³åŸºç¡€æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#kubernetesç›¸å…³åŸºç¡€æ¦‚å¿µ" aria-hidden="true">#</a> Kubernetesç›¸å…³åŸºç¡€æ¦‚å¿µï¼Ÿ</h3><p><strong>Master</strong></p><p>k8sé›†ç¾¤çš„ç®¡ç†èŠ‚ç‚¹ï¼Œè´Ÿè´£ç®¡ç†é›†ç¾¤ï¼Œæä¾›é›†ç¾¤çš„èµ„æºæ•°æ®è®¿é—®å…¥å£ã€‚æ‹¥æœ‰ETCDå­˜å‚¨æœåŠ¡ï¼Œè¿è¡ŒApi Serverè¿›ç¨‹ï¼ŒController ManageræœåŠ¡è¿›ç¨‹åŠScheduleræœåŠ¡è¿›ç¨‹ã€‚</p><p><strong>Node(worker)</strong></p><p>Node(worker)æ˜¯Kubernetesé›†ç¾¤æ¶æ„ä¸­è¿è¡ŒPodçš„æœåŠ¡èŠ‚ç‚¹ï¼Œæ˜¯Kubernetesé›†ç¾¤æ“ä½œçš„å•å…ƒï¼Œç”¨æ¥æ‰¿è½½è¢«åˆ†é…Podçš„è¿è¡Œï¼Œæ˜¯Podè¿è¡Œçš„å®¿ä¸»æœºã€‚è¿è¡Œdocker eningeæœåŠ¡ï¼Œå®ˆæŠ¤è¿›ç¨‹kuneletåŠè´Ÿè½½å‡è¡¡å™¨kube-proxyã€‚</p><p><strong>Pod</strong></p><p>è¿è¡ŒäºNodeèŠ‚ç‚¹ä¸Šï¼Œè‹¥å¹²ç›¸å…³å®¹å™¨çš„ç»„åˆã€‚Podå†…åŒ…å«çš„å®¹å™¨è¿è¡Œåœ¨åŒä¸€å®¿ä¸»æœºä¸Šï¼Œä½¿ç”¨ç›¸åŒçš„ç½‘ç»œå‘½åç©ºé—´ã€IPåœ°å€å’Œç«¯å£ï¼Œèƒ½å¤Ÿé€šè¿‡localhostè¿›è¡Œé€šä¿¡ã€‚Podæ˜¯Kurbernetesè¿›è¡Œåˆ›å»ºã€è°ƒåº¦å’Œç®¡ç†çš„æœ€å°å•ä½ï¼Œå®ƒæä¾›äº†æ¯”å®¹å™¨æ›´é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼Œä½¿å¾—éƒ¨ç½²å’Œç®¡ç†æ›´åŠ çµæ´»ã€‚ä¸€ä¸ªPodå¯ä»¥åŒ…å«ä¸€ä¸ªå®¹å™¨æˆ–è€…å¤šä¸ªç›¸å…³å®¹å™¨ã€‚</p><p><strong>Label</strong></p><p>Kubernetesä¸­çš„å®è´¨æ˜¯ä¸€ç³»åˆ—çš„Key/Valueé”®å€¼å¯¹ï¼Œå…¶ä¸­keyä¸valueå¯è‡ªå®šä¹‰ã€‚Labelå¯ä»¥é™„åŠ åˆ°å„ç§èµ„æºå¯¹è±¡ä¸Šï¼Œå¦‚Nodeã€Podã€Serviceã€RCç­‰ã€‚ä¸€ä¸ªèµ„æºå¯¹è±¡å¯ä»¥å®šä¹‰ä»»æ„æ•°é‡çš„Labelï¼ŒåŒä¸€ä¸ªLabelä¹Ÿå¯ä»¥è¢«æ·»åŠ åˆ°ä»»æ„æ•°é‡çš„èµ„æºå¯¹è±¡ä¸Šå»ã€‚Kubernetesé€šè¿‡Label SelectoræŸ¥è¯¢å’Œç­›é€‰èµ„æºå¯¹è±¡ã€‚</p><p><strong>Replication Controller</strong></p><p>Replication Controllerç”¨æ¥ç®¡ç†Podçš„å‰¯æœ¬ï¼Œä¿è¯é›†ç¾¤ä¸­å­˜åœ¨æŒ‡å®šæ•°é‡çš„Podå‰¯æœ¬ã€‚é›†ç¾¤ä¸­å‰¯æœ¬çš„æ•°é‡å¤§äºæŒ‡å®šæ•°é‡ï¼Œåˆ™ä¼šåœæ­¢æŒ‡å®šæ•°é‡ä¹‹å¤–çš„å¤šä½™å®¹å™¨æ•°é‡ã€‚åä¹‹ï¼Œåˆ™ä¼šå¯åŠ¨ å°‘äºæŒ‡å®šæ•°é‡ä¸ªæ•°çš„å®¹å™¨ï¼Œä¿è¯æ•°é‡ä¸å˜ã€‚RCæ˜¯å®ç°å¼¹æ€§ä¼¸ç¼©ã€åŠ¨æ€æ‰©å®¹å’Œæ»šåŠ¨å‡çº§çš„æ ¸å¿ƒã€‚</p><p><strong>Deployment</strong></p><p>Deploymentåœ¨å†…éƒ¨ä½¿ç”¨äº†RSæ¥å®ç°ç›®çš„ï¼ŒDeploymentç›¸å½“äºRCçš„ä¸€æ¬¡å‡çº§ï¼Œå…¶æœ€å¤§çš„ç‰¹è‰²ä¸ºå¯ä»¥éšæ—¶è·çŸ¥å½“å‰Podçš„éƒ¨ç½²è¿›åº¦ã€‚</p><p><strong>HPA</strong></p><p>Podçš„æ¨ªå‘è‡ªåŠ¨æ‰©å®¹ï¼Œä¹Ÿæ˜¯Kubernetesçš„ä¸€ç§èµ„æºï¼Œé€šè¿‡è¿½è¸ªåˆ†æRCæ§åˆ¶çš„æ‰€æœ‰Podç›®æ ‡çš„è´Ÿè½½å˜åŒ–æƒ…å†µï¼Œæ¥ç¡®å®šæ˜¯å¦éœ€è¦é’ˆå¯¹æ€§çš„è°ƒæ•´Podå‰¯æœ¬æ•°é‡ã€‚</p><p><strong>Service</strong></p><p>å®šä¹‰äº†Podçš„é€»è¾‘é›†åˆå’Œè®¿é—®è¯¥é›†åˆçš„ç­–ç•¥ï¼Œæ˜¯çœŸå®æœåŠ¡çš„æŠ½è±¡ã€‚Serviceæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æœåŠ¡è®¿é—®å…¥å£ä»¥åŠæœåŠ¡ä»£ç†å’Œå‘ç°æœºåˆ¶ï¼Œå…³è”å¤šä¸ªç›¸åŒLabelçš„Podï¼Œç”¨æˆ·ä¸éœ€è¦äº†è§£åå°Podæ˜¯å¦‚ä½•è¿è¡Œã€‚</p><p><strong>Volume</strong></p><p>Volumeæ˜¯Podä¸­èƒ½å¤Ÿè¢«å¤šä¸ªå®¹å™¨è®¿é—®çš„å…±äº«ç›®å½•ï¼ŒKubernetesä¸­çš„Volumeæ˜¯å®šä¹‰åœ¨Podä¸Šï¼Œå¯ä»¥è¢«ä¸€ä¸ªæˆ–å¤šä¸ªPodä¸­çš„å®¹å™¨æŒ‚è½½åˆ°æŸä¸ªç›®å½•ä¸‹ã€‚</p><p><strong>Namespace</strong></p><p>Namespaceç”¨äºå®ç°å¤šç§Ÿæˆ·çš„èµ„æºéš”ç¦»ï¼Œå¯å°†é›†ç¾¤å†…éƒ¨çš„èµ„æºå¯¹è±¡åˆ†é…åˆ°ä¸åŒçš„Namespaceä¸­ï¼Œå½¢æˆé€»è¾‘ä¸Šçš„ä¸åŒé¡¹ç›®ã€å°ç»„æˆ–ç”¨æˆ·ç»„ï¼Œä¾¿äºä¸åŒçš„Namespaceåœ¨å…±äº«ä½¿ç”¨æ•´ä¸ªé›†ç¾¤çš„èµ„æºçš„åŒæ—¶è¿˜èƒ½è¢«åˆ†åˆ«ç®¡ç†ã€‚</p><h3 id="kubernetesé›†ç¾¤ç›¸å…³ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#kubernetesé›†ç¾¤ç›¸å…³ç»„ä»¶" aria-hidden="true">#</a> Kubernetesé›†ç¾¤ç›¸å…³ç»„ä»¶ï¼Ÿ</h3><p><strong>API Server</strong></p><p>ä½œä¸ºKubernetesç³»ç»Ÿçš„å…¥å£ï¼Œå…¶å°è£…äº†æ ¸å¿ƒå¯¹è±¡çš„å¢åˆ æ”¹æŸ¥æ“ä½œï¼Œä»¥RESTful APIæ¥å£æ–¹å¼æä¾›ç»™å¤–éƒ¨å®¢æˆ·å’Œå†…éƒ¨ç»„ä»¶è°ƒç”¨ï¼Œé›†ç¾¤å†…å„ä¸ªåŠŸèƒ½æ¨¡å—ä¹‹é—´æ•°æ®äº¤äº’å’Œé€šä¿¡çš„ä¸­å¿ƒæ¢çº½ã€‚</p><p><strong>Scheduler</strong></p><p>ä¸ºæ–°å»ºç«‹çš„Podè¿›è¡ŒèŠ‚ç‚¹(node)é€‰æ‹©(å³åˆ†é…æœºå™¨)ï¼Œè´Ÿè´£é›†ç¾¤çš„èµ„æºè°ƒåº¦ã€‚</p><p><strong>Kubernetes Controller</strong></p><p>è´Ÿè´£æ‰§è¡Œå„ç§æ§åˆ¶å™¨ï¼Œç›®å‰å·²ç»æä¾›äº†å¾ˆå¤šæ§åˆ¶å™¨æ¥ä¿è¯Kubernetesçš„æ­£å¸¸è¿è¡Œã€‚</p><p><strong>Replication Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Replication Controllerï¼Œå…³è”Replication Controllerå’ŒPodï¼Œä¿è¯Replication Controllerå®šä¹‰çš„å‰¯æœ¬æ•°é‡ä¸å®é™…è¿è¡ŒPodæ•°é‡ä¸€è‡´ã€‚</p><p><strong>Node Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Nodeï¼Œå®šæœŸæ£€æŸ¥Nodeçš„å¥åº·çŠ¶æ€ï¼Œæ ‡è¯†å‡º(å¤±æ•ˆ|æœªå¤±æ•ˆ)çš„NodeèŠ‚ç‚¹ã€‚</p><p><strong>Namespace Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Namespaceï¼Œå®šæœŸæ¸…ç†æ— æ•ˆçš„Namespaceï¼ŒåŒ…æ‹¬Namesapceä¸‹çš„APIå¯¹è±¡ï¼Œæ¯”å¦‚Podã€Serviceç­‰ã€‚</p><p><strong>Service Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Serviceï¼Œæä¾›è´Ÿè½½ä»¥åŠæœåŠ¡ä»£ç†ã€‚</p><p><strong>EndPoints Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Endpointsï¼Œå…³è”Serviceå’ŒPodï¼Œåˆ›å»ºEndpointsä¸ºServiceçš„åç«¯ï¼Œ å½“Podå‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®æ—¶æ›´æ–°Endpointsã€‚</p><p><strong>Service Account Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Service Accountï¼Œä¸ºæ¯ä¸ªNamespaceåˆ›å»ºé»˜è®¤çš„Service Accountï¼ŒåŒæ—¶ä¸ºService Accountåˆ›å»ºService Account Secretã€‚ Persistent Volume Controllerï¼šç®¡ç†ç»´æŠ¤Persistent Volumeå’ŒPersistent Volume Claimï¼Œä¸ºæ–°çš„Persistent Volume Claimåˆ†é…Persistent Volumeè¿›è¡Œç»‘å®šï¼Œä¸ºé‡Šæ”¾çš„Persistent Volumeæ‰§è¡Œæ¸…ç†å›æ”¶ã€‚</p><p><strong>Daemon Set Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Daemon Setï¼Œè´Ÿè´£åˆ›å»ºDaemon Podï¼Œä¿è¯æŒ‡å®šçš„Nodeä¸Šæ­£å¸¸çš„è¿è¡ŒDaemon Podã€‚</p><p><strong>Deployment Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Deploymentï¼Œå…³è”Deploymentå’ŒReplication Controllerï¼Œä¿è¯è¿è¡ŒæŒ‡å®šæ•°é‡çš„Podã€‚å½“Deploymentæ›´æ–°æ—¶ï¼Œæ§åˆ¶å®ç°Replication Controllerå’ŒPodçš„æ›´æ–°ã€‚</p><p><strong>Job Controller</strong></p><p>ç®¡ç†ç»´æŠ¤Jobï¼Œä¸ºJodåˆ›å»ºä¸€æ¬¡æ€§ä»»åŠ¡Podï¼Œä¿è¯å®ŒæˆJobæŒ‡å®šå®Œæˆçš„ä»»åŠ¡æ•°ç›®</p><p><strong>Pod Autoscaler Controller</strong></p><p>å®ç°Podçš„è‡ªåŠ¨ä¼¸ç¼©ï¼Œå®šæ—¶è·å–ç›‘æ§æ•°æ®ï¼Œè¿›è¡Œç­–ç•¥åŒ¹é…ï¼Œå½“æ»¡è¶³æ¡ä»¶æ—¶æ‰§è¡ŒPodçš„ä¼¸ç¼©åŠ¨ä½œã€‚</p><h3 id="kubernetes-rcçš„æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#kubernetes-rcçš„æœºåˆ¶" aria-hidden="true">#</a> Kubernetes RCçš„æœºåˆ¶ï¼Ÿ</h3><p>Replication Controllerç”¨æ¥ç®¡ç†Podçš„å‰¯æœ¬ï¼Œä¿è¯é›†ç¾¤ä¸­å­˜åœ¨æŒ‡å®šæ•°é‡çš„Podå‰¯æœ¬ã€‚å½“å®šä¹‰äº†RCå¹¶æäº¤è‡³Kubernetesé›†ç¾¤ä¸­ä¹‹åï¼ŒMasterèŠ‚ç‚¹ä¸Šçš„Controller Managerç»„ä»¶è·æ‚‰ï¼Œå¹¶åŒæ—¶å·¡æ£€ç³»ç»Ÿä¸­å½“å‰å­˜æ´»çš„ç›®æ ‡Podï¼Œå¹¶ç¡®ä¿ç›®æ ‡Podå®ä¾‹çš„æ•°é‡åˆšå¥½ç­‰äºæ­¤RCçš„æœŸæœ›å€¼ï¼Œè‹¥å­˜åœ¨è¿‡å¤šçš„Podå‰¯æœ¬åœ¨è¿è¡Œï¼Œç³»ç»Ÿä¼šåœæ­¢ä¸€äº›Podï¼Œåä¹‹åˆ™è‡ªåŠ¨åˆ›å»ºä¸€äº›Podã€‚</p><h3 id="kubernetes-replica-set-å’Œ-replication-controller-ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#kubernetes-replica-set-å’Œ-replication-controller-ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> Kubernetes Replica Set å’Œ Replication Controller ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>Replica Setå’ŒReplication Controllerç±»ä¼¼ï¼Œéƒ½æ˜¯ç¡®ä¿åœ¨ä»»ä½•ç»™å®šæ—¶é—´è¿è¡ŒæŒ‡å®šæ•°é‡çš„Podå‰¯æœ¬ã€‚ä¸åŒä¹‹å¤„åœ¨äºRSä½¿ç”¨åŸºäºé›†åˆçš„é€‰æ‹©å™¨ï¼Œè€ŒReplication Controllerä½¿ç”¨åŸºäºæƒé™çš„é€‰æ‹©å™¨ã€‚</p><h3 id="kube-proxyä½œç”¨" tabindex="-1"><a class="header-anchor" href="#kube-proxyä½œç”¨" aria-hidden="true">#</a> kube-proxyä½œç”¨ï¼Ÿ</h3><p>kube-proxyè¿è¡Œåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šï¼Œå®ƒç›‘å¬apiserverä¸­serviceå’Œendpointçš„å˜åŒ–æƒ…å†µï¼Œåˆ›å»ºè·¯ç”±è§„åˆ™ä»¥æä¾›æœåŠ¡IPå’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚Serviceçš„é€æ˜ä»£ç†å…¼è´Ÿè½½å‡è¡¡å™¨ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯å°†åˆ°æŸä¸ªServiceçš„è®¿é—®è¯·æ±‚è½¬å‘åˆ°åç«¯çš„å¤šä¸ªPodå®ä¾‹ä¸Šã€‚</p><h3 id="kube-proxy-iptablesåŸç†" tabindex="-1"><a class="header-anchor" href="#kube-proxy-iptablesåŸç†" aria-hidden="true">#</a> kube-proxy iptablesåŸç†ï¼Ÿ</h3><p>Kubernetesä»1.2ç‰ˆæœ¬å¼€å§‹ï¼Œå°†iptablesä½œä¸ºkube-proxyçš„é»˜è®¤æ¨¡å¼ã€‚iptablesæ¨¡å¼ä¸‹çš„kube-proxyä¸å†èµ·åˆ°Proxyçš„ä½œç”¨ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½ï¼šé€šè¿‡API Serverçš„Watchæ¥å£å®æ—¶è·Ÿè¸ªServiceä¸Endpointçš„å˜æ›´ä¿¡æ¯ï¼Œå¹¶æ›´æ–°å¯¹åº”çš„iptablesè§„åˆ™ï¼ŒClientçš„è¯·æ±‚æµé‡åˆ™é€šè¿‡iptablesçš„NATæœºåˆ¶è·¯ç”±åˆ°ç›®æ ‡Podã€‚</p><h3 id="kube-proxy-ipvsåŸç†" tabindex="-1"><a class="header-anchor" href="#kube-proxy-ipvsåŸç†" aria-hidden="true">#</a> kube-proxy ipvsåŸç†ï¼Ÿ</h3><p>IPVSåœ¨Kubernetes1.11ä¸­å‡çº§ä¸ºGAç¨³å®šç‰ˆã€‚IPVSåˆ™ä¸“é—¨ç”¨äºé«˜æ€§èƒ½è´Ÿè½½å‡è¡¡ï¼Œå¹¶ä½¿ç”¨æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„(Hashè¡¨ï¼‰ï¼Œå…è®¸å‡ ä¹æ— é™çš„è§„æ¨¡æ‰©å¼ ï¼Œå› æ­¤è¢«kube-proxyé‡‡çº³ä¸ºæœ€æ–°æ¨¡å¼ã€‚</p><p>åœ¨IPVSæ¨¡å¼ä¸‹ï¼Œä½¿ç”¨iptablesçš„æ‰©å±•ipsetï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨iptablesæ¥ç”Ÿæˆè§„åˆ™é“¾ã€‚iptablesè§„åˆ™é“¾æ˜¯ä¸€ä¸ªçº¿æ€§çš„æ•°æ®ç»“æ„ï¼Œipsetåˆ™å¼•å…¥äº†å¸¦ç´¢å¼•çš„æ•°æ®ç»“æ„ï¼Œå› æ­¤å½“è§„åˆ™å¾ˆå¤šæ—¶ï¼Œä¹Ÿå¯ä»¥å¾ˆé«˜æ•ˆåœ°æŸ¥æ‰¾å’ŒåŒ¹ é…ã€‚</p><p>å¯ä»¥å°†ipsetç®€å•ç†è§£ä¸ºä¸€ä¸ªIPçš„é›†åˆï¼Œè¿™ä¸ªé›†åˆçš„å†…å®¹å¯ä»¥æ˜¯IPåœ°å€ã€IPç½‘æ®µã€ç«¯å£ç­‰ï¼Œiptableså¯ä»¥ç›´æ¥æ·»åŠ è§„åˆ™å¯¹è¿™ä¸ªå¯å˜çš„é›†åˆè¿›è¡Œæ“ä½œï¼Œè¿™æ ·åšçš„å¥½å¤„åœ¨äºå¯ä»¥å¤§å¤§å‡å°‘iptablesè§„åˆ™çš„æ•°é‡ï¼Œ ä»è€Œå‡å°‘æ€§èƒ½æŸè€—ã€‚</p><h3 id="kube-proxy-ipvså’Œiptablesçš„å¼‚åŒ" tabindex="-1"><a class="header-anchor" href="#kube-proxy-ipvså’Œiptablesçš„å¼‚åŒ" aria-hidden="true">#</a> kube-proxy ipvså’Œiptablesçš„å¼‚åŒï¼Ÿ</h3><p>iptablesä¸IPVSéƒ½æ˜¯åŸºäºNetfilterå®ç°çš„ï¼Œä½†å› ä¸ºå®šä½ä¸åŒï¼ŒäºŒè€…æœ‰ç€æœ¬è´¨çš„å·®åˆ«ï¼šiptablesæ˜¯ä¸ºé˜²ç«å¢™è€Œè®¾è®¡çš„ï¼›IPVSåˆ™ä¸“é—¨ç”¨äºé«˜æ€§èƒ½è´Ÿè½½å‡è¡¡ï¼Œå¹¶ä½¿ç”¨æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„(Hashè¡¨ï¼‰ã€‚</p><p>ä¸iptablesç›¸æ¯”ï¼ŒIPVSæ‹¥æœ‰ä»¥ä¸‹æ˜æ˜¾ä¼˜åŠ¿ï¼š</p><ul><li><p>ä¸ºå¤§å‹é›†ç¾¤æä¾›äº†æ›´å¥½çš„å¯æ‰©å±•æ€§å’Œæ€§èƒ½</p></li><li><p>æ”¯æŒæ¯”iptablesæ›´å¤æ‚çš„å¤åˆ¶å‡è¡¡ç®—æ³•(æœ€å°è´Ÿè½½ã€æœ€å°‘è¿æ¥ã€åŠ æƒç­‰ï¼‰</p></li><li><p>æ”¯æŒæœåŠ¡å™¨å¥åº·æ£€æŸ¥å’Œè¿æ¥é‡è¯•ç­‰åŠŸèƒ½</p></li><li><p>å¯ä»¥åŠ¨æ€ä¿®æ”¹ipsetçš„é›†åˆï¼Œå³ä½¿iptablesçš„è§„åˆ™æ­£åœ¨ä½¿ç”¨è¿™ä¸ªé›†åˆ</p></li></ul><h3 id="kubernetesä¸­ä»€ä¹ˆæ˜¯é™æ€pod" tabindex="-1"><a class="header-anchor" href="#kubernetesä¸­ä»€ä¹ˆæ˜¯é™æ€pod" aria-hidden="true">#</a> Kubernetesä¸­ä»€ä¹ˆæ˜¯é™æ€Podï¼Ÿ</h3><p>é™æ€podæ˜¯ç”±kubeletè¿›è¡Œç®¡ç†çš„ä»…å­˜åœ¨äºç‰¹å®šNodeçš„Podä¸Šï¼Œä»–ä»¬ä¸èƒ½é€šè¿‡API Serverè¿›è¡Œç®¡ç†ï¼Œæ— æ³•ä¸ReplicationControllerã€Deploymentæˆ–è€…DaemonSetè¿›è¡Œå…³è”ï¼Œå¹¶ä¸”kubeletæ— æ³•å¯¹ä»–ä»¬è¿›è¡Œå¥åº·æ£€ æŸ¥ã€‚é™æ€Podæ€»æ˜¯ç”±kubeletè¿›è¡Œåˆ›å»ºï¼Œå¹¶ä¸”æ€»æ˜¯åœ¨kubeletæ‰€åœ¨çš„Nodeä¸Šè¿è¡Œã€‚</p><h3 id="kubernetesä¸­podå¯èƒ½ä½äºçš„çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#kubernetesä¸­podå¯èƒ½ä½äºçš„çŠ¶æ€" aria-hidden="true">#</a> Kubernetesä¸­Podå¯èƒ½ä½äºçš„çŠ¶æ€ï¼Ÿ</h3><p>Pendingï¼šAPI Serverå·²ç»åˆ›å»ºè¯¥Podï¼Œä¸”Podå†…è¿˜æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨çš„é•œåƒæ²¡æœ‰åˆ›å»ºï¼ŒåŒ…æ‹¬æ­£åœ¨ä¸‹è½½é•œåƒçš„è¿‡ç¨‹ã€‚</p><p>Runningï¼šPodå†…æ‰€æœ‰å®¹å™¨å‡å·²åˆ›å»ºï¼Œä¸”è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨å¤„äºè¿è¡ŒçŠ¶æ€ã€æ­£åœ¨å¯åŠ¨çŠ¶æ€æˆ–æ­£åœ¨é‡å¯çŠ¶æ€ã€‚</p><p>Succeededï¼šPodå†…æ‰€æœ‰å®¹å™¨å‡æˆåŠŸæ‰§è¡Œé€€å‡ºï¼Œä¸”ä¸ä¼šé‡å¯ã€‚</p><p>Failedï¼šPodå†…æ‰€æœ‰å®¹å™¨å‡å·²é€€å‡ºï¼Œä½†è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨é€€å‡ºä¸ºå¤±è´¥çŠ¶æ€ã€‚</p><p>Unknownï¼šç”±äºæŸç§åŸå› æ— æ³•è·å–è¯¥PodçŠ¶æ€ï¼Œå¯èƒ½ç”±äºç½‘ç»œé€šä¿¡ä¸ç•…å¯¼è‡´ã€‚</p><h3 id="kubernetesåˆ›å»ºä¸€ä¸ªpodçš„ä¸»è¦æµç¨‹" tabindex="-1"><a class="header-anchor" href="#kubernetesåˆ›å»ºä¸€ä¸ªpodçš„ä¸»è¦æµç¨‹" aria-hidden="true">#</a> Kubernetesåˆ›å»ºä¸€ä¸ªPodçš„ä¸»è¦æµç¨‹ï¼Ÿ</h3><p>Kubernetesä¸­åˆ›å»ºä¸€ä¸ªPodæ¶‰åŠå¤šä¸ªç»„ä»¶ä¹‹é—´è”åŠ¨ï¼Œä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li><p>å®¢æˆ·ç«¯æäº¤Podçš„é…ç½®ä¿¡æ¯(å¯ä»¥æ˜¯yamlæ–‡ä»¶å®šä¹‰çš„ä¿¡æ¯ï¼‰åˆ°kube-apiserverã€‚</p></li><li><p>Apiserveræ”¶åˆ°æŒ‡ä»¤åï¼Œé€šçŸ¥ç»™controller-manageråˆ›å»ºä¸€ä¸ªèµ„æºå¯¹è±¡ã€‚</p></li><li><p>Controller-manageré€šè¿‡api-serverå°†podçš„é…ç½®ä¿¡æ¯å­˜å‚¨åˆ°ETCDæ•°æ®ä¸­å¿ƒä¸­ã€‚</p></li><li><p>Kube-scheduleræ£€æµ‹åˆ°podä¿¡æ¯ä¼šå¼€å§‹è°ƒåº¦é¢„é€‰ï¼Œä¼šå…ˆè¿‡æ»¤æ‰ä¸ç¬¦åˆPodèµ„æºé…ç½®è¦æ±‚çš„èŠ‚ç‚¹ï¼Œç„¶åå¼€å§‹è°ƒåº¦è°ƒä¼˜ï¼Œä¸»è¦æ˜¯æŒ‘é€‰å‡ºæ›´é€‚åˆè¿è¡Œpodçš„èŠ‚ç‚¹ï¼Œç„¶åå°†podçš„èµ„æºé…ç½®å•å‘é€åˆ°nodeèŠ‚ç‚¹ä¸Šçš„kubeletç»„ä»¶ä¸Šã€‚</p></li><li><p>Kubeletæ ¹æ®schedulerå‘æ¥çš„èµ„æºé…ç½®å•è¿è¡Œpodï¼Œè¿è¡ŒæˆåŠŸåï¼Œå°†podçš„è¿è¡Œä¿¡æ¯è¿”å›ç»™schedulerï¼Œschedulerå°†è¿”å›çš„podè¿è¡ŒçŠ¶å†µçš„ä¿¡æ¯å­˜å‚¨åˆ°etcdæ•°æ®ä¸­å¿ƒã€‚</p></li></ul><h3 id="kubernetesä¸­podçš„é‡å¯ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#kubernetesä¸­podçš„é‡å¯ç­–ç•¥" aria-hidden="true">#</a> Kubernetesä¸­Podçš„é‡å¯ç­–ç•¥ï¼Ÿ</h3><p>Podé‡å¯ç­–ç•¥(RestartPolicyï¼‰åº”ç”¨äºPodå†…çš„æ‰€æœ‰å®¹å™¨ï¼Œå¹¶ä¸”ä»…åœ¨Podæ‰€å¤„çš„Nodeä¸Šç”±kubeletè¿›è¡Œåˆ¤æ–­å’Œé‡å¯æ“ä½œã€‚å½“æŸä¸ªå®¹å™¨å¼‚å¸¸é€€å‡ºæˆ–è€…å¥åº·æ£€æŸ¥å¤±è´¥æ—¶ï¼Œkubeletå°†æ ¹æ®RestartPolicyçš„è®¾ç½®æ¥è¿›è¡Œç›¸åº”æ“ä½œã€‚Podçš„é‡å¯ç­–ç•¥åŒ…æ‹¬Alwaysã€OnFailureå’ŒNeverï¼Œé»˜è®¤å€¼ä¸ºAlwaysã€‚</p><ul><li><p>Alwaysï¼šå½“ å®¹ å™¨ å¤± æ•ˆ æ—¶ ï¼Œ ç”± kubelet è‡ª åŠ¨ é‡ å¯ è¯¥ å®¹ å™¨</p></li><li><p>OnFailureï¼šå½“å®¹å™¨ç»ˆæ­¢è¿è¡Œä¸”é€€å‡ºç ä¸ä¸º0æ—¶ï¼Œç”±kubeletè‡ªåŠ¨é‡å¯è¯¥å®¹å™¨</p></li><li><p>Neverï¼šä¸è®ºå®¹å™¨è¿è¡ŒçŠ¶æ€å¦‚ä½•ï¼Œkubeletéƒ½ä¸ä¼šé‡å¯è¯¥å®¹å™¨</p></li></ul><p>åŒæ—¶Podçš„é‡å¯ç­–ç•¥ä¸æ§åˆ¶æ–¹å¼å…³è”ï¼Œå½“å‰å¯ç”¨äºç®¡ç†Podçš„æ§åˆ¶å™¨åŒ…æ‹¬ReplicationControllerã€Jobã€DaemonSetåŠç›´æ¥ç®¡ç†kubeletç®¡ç†(é™æ€Podï¼‰ã€‚</p><p>ä¸åŒæ§åˆ¶å™¨çš„é‡å¯ç­–ç•¥é™åˆ¶å¦‚ä¸‹ï¼š</p><ul><li>RCå’ŒDaemonSetï¼šå¿…é¡»è®¾ç½®ä¸ºAlwaysï¼Œéœ€è¦ä¿è¯è¯¥å®¹å™¨æŒç»­è¿è¡Œ</li><li>Jobï¼šOnFailureæˆ–Neverï¼Œç¡®ä¿å®¹å™¨æ‰§è¡Œå®Œæˆåä¸å†é‡å¯</li><li>kubeletï¼šåœ¨Podå¤±æ•ˆæ—¶é‡å¯ï¼Œä¸è®ºå°†RestartPolicyè®¾ç½®ä¸ºä½•å€¼ï¼Œä¹Ÿä¸ä¼šå¯¹Podè¿›è¡Œå¥åº·æ£€æŸ¥</li></ul><h3 id="kubernetesä¸­podçš„å¥åº·æ£€æŸ¥æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#kubernetesä¸­podçš„å¥åº·æ£€æŸ¥æ–¹å¼" aria-hidden="true">#</a> Kubernetesä¸­Podçš„å¥åº·æ£€æŸ¥æ–¹å¼ï¼Ÿ</h3><p>å¯¹Podçš„å¥åº·æ£€æŸ¥å¯ä»¥é€šè¿‡ä¸¤ç±»æ¢é’ˆæ¥æ£€æŸ¥ï¼šLivenessProbeå’ŒReadinessProbeã€‚</p><ul><li><p>LivenessProbeæ¢é’ˆï¼šç”¨äºåˆ¤æ–­å®¹å™¨æ˜¯å¦å­˜æ´»(runningçŠ¶æ€ï¼‰ï¼Œå¦‚æœLivenessProbeæ¢é’ˆæ¢æµ‹åˆ°å®¹å™¨ä¸å¥åº·ï¼Œåˆ™kubeletå°†æ€æ‰è¯¥å®¹å™¨ï¼Œå¹¶æ ¹æ®å®¹å™¨çš„é‡å¯ç­–ç•¥åšç›¸åº”å¤„ç†ã€‚è‹¥ä¸€ä¸ªå®¹å™¨ä¸åŒ…å«LivenessProbeæ¢é’ˆï¼Œkubeletè®¤ä¸ºè¯¥å®¹å™¨çš„LivenessProbeæ¢é’ˆè¿”å›å€¼ç”¨äºæ˜¯â€œSuccessâ€ã€‚</p></li><li><p>ReadineeProbeæ¢é’ˆï¼šç”¨äºåˆ¤æ–­å®¹å™¨æ˜¯å¦å¯åŠ¨å®Œæˆ(readyçŠ¶æ€ï¼‰ã€‚å¦‚æœReadinessProbeæ¢é’ˆæ¢æµ‹åˆ°å¤±è´¥ï¼Œåˆ™Podçš„çŠ¶æ€å°†è¢«ä¿®æ”¹ã€‚Endpoint Controllerå°†ä»Serviceçš„Endpointä¸­åˆ é™¤åŒ…å«è¯¥å®¹å™¨æ‰€åœ¨Pod çš„Eenpointã€‚</p></li><li><p>startupProbeæ¢é’ˆï¼šå¯åŠ¨æ£€æŸ¥æœºåˆ¶ï¼Œåº”ç”¨ä¸€äº›å¯åŠ¨ç¼“æ…¢çš„ä¸šåŠ¡ï¼Œé¿å…ä¸šåŠ¡é•¿æ—¶é—´å¯åŠ¨è€Œè¢«ä¸Šé¢ä¸¤ç±»æ¢é’ˆkillæ‰ã€‚</p></li></ul><h3 id="kubernetes-podçš„livenessprobeæ¢é’ˆçš„å¸¸è§æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#kubernetes-podçš„livenessprobeæ¢é’ˆçš„å¸¸è§æ–¹å¼" aria-hidden="true">#</a> Kubernetes Podçš„LivenessProbeæ¢é’ˆçš„å¸¸è§æ–¹å¼ï¼Ÿ</h3><p>kubeletå®šæœŸæ‰§è¡ŒLivenessProbeæ¢é’ˆæ¥è¯Šæ–­å®¹å™¨çš„å¥åº·çŠ¶æ€ï¼Œé€šå¸¸æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š</p><p>ExecActionï¼šåœ¨å®¹å™¨å†…æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ ï¼Œ è‹¥è¿”å›ç ä¸º0ï¼Œåˆ™è¡¨æ˜å®¹å™¨å¥åº·ã€‚</p><p>TCPSocketActionï¼šé€šè¿‡å®¹å™¨çš„IPåœ°å€å’Œç«¯å£å·æ‰§è¡ŒTCPæ£€æŸ¥ï¼Œè‹¥èƒ½å»ºç«‹TCPè¿æ¥ï¼Œåˆ™è¡¨æ˜å®¹å™¨å¥åº·ã€‚</p><p>HTTPGetActionï¼šé€šè¿‡å®¹å™¨çš„IPåœ°å€ã€ç«¯å£å·åŠè·¯å¾„è°ƒç”¨HTTP Getæ–¹æ³•ï¼Œè‹¥å“åº”çš„çŠ¶æ€ç å¤§äºç­‰äº200ä¸”å°äº400ï¼Œåˆ™è¡¨æ˜å®¹å™¨å¥åº·ã€‚</p><h3 id="kubernetes-podçš„å¸¸è§è°ƒåº¦æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#kubernetes-podçš„å¸¸è§è°ƒåº¦æ–¹å¼" aria-hidden="true">#</a> Kubernetes Podçš„å¸¸è§è°ƒåº¦æ–¹å¼ï¼Ÿ</h3><p><strong>Deploymentæˆ–RC</strong></p><p>è¯¥è°ƒåº¦ç­–ç•¥ä¸»è¦åŠŸèƒ½å°±æ˜¯è‡ªåŠ¨éƒ¨ç½²ä¸€ä¸ªå®¹å™¨åº”ç”¨çš„å¤šä»½å‰¯æœ¬ï¼Œä»¥åŠæŒç»­ç›‘æ§å‰¯æœ¬çš„æ•°é‡ï¼Œåœ¨é›†ç¾¤å†…å§‹ç»ˆç»´æŒç”¨æˆ·æŒ‡å®šçš„å‰¯æœ¬æ•°é‡ã€‚</p><p><strong>NodeSelector</strong></p><p>å®šå‘è°ƒåº¦ï¼Œå½“éœ€è¦æ‰‹åŠ¨æŒ‡å®šå°†Podè°ƒåº¦åˆ°ç‰¹å®šNodeä¸Šï¼Œå¯ä»¥é€šè¿‡Nodeçš„æ ‡ç­¾ã€‚Labelå’ŒPodçš„nodeSelectorå±æ€§ç›¸åŒ¹é…ã€‚</p><p><strong>NodeAffinityäº²å’Œæ€§è°ƒåº¦</strong></p><p>requiredDuringSchedulingIgnoredDuringExecutionï¼šç¡¬è§„åˆ™ï¼Œå¿…é¡»æ»¡è¶³æŒ‡å®šçš„è§„åˆ™ï¼Œè°ƒåº¦å™¨æ‰å¯ä»¥è°ƒåº¦Podè‡³Nodeä¸Š(ç±»ä¼¼nodeSelectorï¼Œè¯­æ³•ä¸åŒï¼‰ã€‚preferredDuringSchedulingIgnoredDuringExecutionï¼šè½¯è§„åˆ™ï¼Œä¼˜å…ˆè°ƒåº¦è‡³æ»¡è¶³çš„Nodeçš„èŠ‚ç‚¹ï¼Œä½†ä¸å¼ºæ±‚ï¼Œå¤šä¸ªä¼˜å…ˆçº§è§„åˆ™è¿˜å¯ä»¥è®¾ç½®æƒé‡å€¼ã€‚</p><p><strong>Taintså’ŒTolerations(æ±¡ç‚¹å’Œå®¹å¿ï¼‰</strong></p><p>ä½¿Nodeæ‹’ç»ç‰¹å®šPodè¿è¡Œã€‚</p><p><strong>Toleration</strong></p><p>ä¸ºPodçš„å±æ€§ï¼Œè¡¨ç¤ºPodèƒ½å®¹å¿æ ‡æ³¨äº†Taintçš„Nodeã€‚</p><h3 id="kubernetesåˆå§‹åŒ–å®¹å™¨-init-container" tabindex="-1"><a class="header-anchor" href="#kubernetesåˆå§‹åŒ–å®¹å™¨-init-container" aria-hidden="true">#</a> Kubernetesåˆå§‹åŒ–å®¹å™¨(init containerï¼‰ï¼Ÿ</h3><p>init containerçš„è¿è¡Œæ–¹å¼ä¸åº”ç”¨å®¹å™¨ä¸åŒï¼Œå®ƒä»¬å¿…é¡»å…ˆäºåº”ç”¨å®¹å™¨æ‰§è¡Œå®Œæˆï¼Œå½“è®¾ç½®äº†å¤šä¸ªinit containeræ—¶ï¼Œå°†æŒ‰é¡ºåºé€ä¸ªè¿è¡Œï¼Œå¹¶ä¸”åªæœ‰å‰ä¸€ä¸ªinit containerè¿è¡ŒæˆåŠŸåæ‰èƒ½è¿è¡Œåä¸€ä¸ªinit containerã€‚å½“æ‰€æœ‰init containeréƒ½æˆåŠŸè¿è¡Œåï¼ŒKubernetesæ‰ä¼šåˆå§‹åŒ–Podçš„å„ç§ä¿¡æ¯ï¼Œå¹¶å¼€å§‹åˆ›å»ºå’Œè¿è¡Œåº”ç”¨å®¹å™¨ã€‚</p><h3 id="kubernetes-deploymentå‡çº§è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#kubernetes-deploymentå‡çº§è¿‡ç¨‹" aria-hidden="true">#</a> Kubernetes deploymentå‡çº§è¿‡ç¨‹ï¼Ÿ</h3><p>åˆå§‹åˆ›å»ºDeploymentæ—¶ï¼Œç³»ç»Ÿåˆ›å»ºäº†ä¸€ä¸ªReplicaSetï¼Œå¹¶æŒ‰ç”¨æˆ·çš„éœ€æ±‚åˆ›å»ºäº†å¯¹åº”æ•°é‡çš„Podå‰¯æœ¬ã€‚å½“æ›´æ–°Deploymentæ—¶ï¼Œç³»ç»Ÿåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ReplicaSetï¼Œå¹¶å°†å…¶å‰¯æœ¬æ•°é‡æ‰©å±•åˆ°1ï¼Œç„¶åå°†æ—§ReplicaSetç¼©å‡ä¸º2ã€‚ä¹‹åï¼Œç³»ç»Ÿç»§ç»­æŒ‰ç…§ç›¸åŒçš„æ›´æ–°ç­–ç•¥å¯¹æ–°æ—§ä¸¤ä¸ªReplicaSetè¿›è¡Œé€ä¸ªè°ƒæ•´ã€‚æœ€åï¼Œæ–°çš„ReplicaSetè¿è¡Œäº†å¯¹åº”ä¸ªæ–°ç‰ˆæœ¬Podå‰¯æœ¬ï¼Œæ—§çš„ReplicaSetå‰¯æœ¬æ•°é‡åˆ™ç¼©å‡ä¸º0ã€‚</p><h3 id="kubernetes-deploymentå‡çº§ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#kubernetes-deploymentå‡çº§ç­–ç•¥" aria-hidden="true">#</a> Kubernetes deploymentå‡çº§ç­–ç•¥ï¼Ÿ</h3><p>åœ¨Deploymentçš„å®šä¹‰ä¸­ï¼Œå¯ä»¥é€šè¿‡spec.strategyæŒ‡å®šPodæ›´æ–°çš„ç­–ç•¥ï¼Œç›®å‰æ”¯æŒä¸¤ç§ç­–ç•¥ï¼š</p><p>Recreate(é‡å»ºï¼‰å’ŒRollingUpdate(æ»šåŠ¨æ›´æ–°ï¼‰ï¼Œé»˜è®¤å€¼ä¸ºRollingUpdateã€‚</p><p>Recreateï¼šè®¾ç½®spec.strategy.type=Recreateï¼Œè¡¨ç¤ºDeploymentåœ¨æ›´æ–°Podæ—¶ï¼Œä¼šå…ˆæ€æ‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„Podï¼Œç„¶ååˆ›å»ºæ–°çš„Podã€‚</p><p>RollingUpdateï¼šè®¾ç½®spec.strategy.type=RollingUpdateï¼Œè¡¨ç¤ºDeploymentä¼šä»¥æ»šåŠ¨æ›´æ–°çš„æ–¹å¼æ¥é€ä¸ªæ›´æ–°Podã€‚åŒæ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®spec.strategy.rollingUpdateä¸‹çš„ä¸¤ä¸ªå‚æ•°(maxUnavailableå’ŒmaxSurgeï¼‰æ¥æ§åˆ¶æ»šåŠ¨æ›´æ–°çš„è¿‡ç¨‹ã€‚</p><h3 id="kubernetes-daemonsetç±»å‹çš„èµ„æºç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#kubernetes-daemonsetç±»å‹çš„èµ„æºç‰¹æ€§" aria-hidden="true">#</a> Kubernetes DaemonSetç±»å‹çš„èµ„æºç‰¹æ€§ï¼Ÿ</h3><p>DaemonSetèµ„æºå¯¹è±¡ä¼šåœ¨æ¯ä¸ªKubernetesé›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹åªèƒ½è¿è¡Œä¸€ä¸ªpodï¼Œè¿™æ˜¯å®ƒå’Œdeploymentèµ„æºå¯¹è±¡çš„æœ€å¤§ä¹Ÿæ˜¯å”¯ä¸€çš„åŒºåˆ«ã€‚å› æ­¤ï¼Œåœ¨å®šä¹‰yamlæ–‡ä»¶ä¸­ï¼Œä¸æ”¯æŒå®šä¹‰replicasã€‚</p><p>å®ƒçš„ä¸€èˆ¬ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼šåœ¨å»åšæ¯ä¸ªèŠ‚ç‚¹çš„æ—¥å¿—æ”¶é›†å·¥ä½œã€‚ç›‘æ§æ¯ä¸ªèŠ‚ç‚¹çš„çš„è¿è¡ŒçŠ¶æ€ã€‚</p><h3 id="kubernetesè‡ªåŠ¨æ‰©å®¹æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#kubernetesè‡ªåŠ¨æ‰©å®¹æœºåˆ¶" aria-hidden="true">#</a> Kubernetesè‡ªåŠ¨æ‰©å®¹æœºåˆ¶ï¼Ÿ</h3><p>Kubernetesä½¿ç”¨Horizontal Pod Autoscaler(HPAï¼‰çš„æ§åˆ¶å™¨å®ç°åŸºäºCPUä½¿ç”¨ç‡è¿›è¡Œè‡ªåŠ¨Podæ‰©ç¼©å®¹çš„åŠŸèƒ½ã€‚HPAæ§åˆ¶å™¨å‘¨æœŸæ€§åœ°ç›‘æµ‹ç›®æ ‡Podçš„èµ„æºæ€§èƒ½æŒ‡æ ‡ï¼Œå¹¶ä¸HPAèµ„æºå¯¹è±¡ä¸­çš„æ‰©ç¼©å®¹æ¡ä»¶è¿›è¡Œå¯¹æ¯”ï¼Œåœ¨æ»¡è¶³æ¡ä»¶æ—¶å¯¹Podå‰¯æœ¬æ•°é‡è¿›è¡Œè°ƒæ•´ã€‚</p><p><strong>HPAåŸç†</strong></p><p>Kubernetesä¸­çš„æŸä¸ªMetrics Server(Heapsteræˆ–è‡ªå®šä¹‰Metrics Serverï¼‰æŒç»­é‡‡é›†æ‰€æœ‰Podå‰¯æœ¬çš„æŒ‡æ ‡æ•°æ®ã€‚HPAæ§åˆ¶å™¨é€šè¿‡Metrics Serverçš„API(Heapsterçš„APIæˆ–èšåˆAPIï¼‰è·å–è¿™äº›æ•°æ®ï¼ŒåŸºäºç”¨æˆ·å®šä¹‰çš„æ‰©ç¼©å®¹è§„åˆ™è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°ç›®æ ‡Podå‰¯æœ¬æ•°é‡ã€‚å½“ç›®æ ‡Podå‰¯æœ¬æ•°é‡ä¸å½“å‰å‰¯æœ¬æ•°é‡ä¸åŒæ—¶ï¼ŒHPAæ§åˆ¶å™¨å°±å‘Podçš„å‰¯æœ¬æ§åˆ¶å™¨(Deploymentã€RCæˆ–ReplicaSetï¼‰å‘èµ·scaleæ“ä½œï¼Œè°ƒæ•´Podçš„å‰¯æœ¬æ•°é‡ï¼Œå®Œæˆæ‰©ç¼©å®¹æ“ä½œã€‚</p><h3 id="kubernetes-serviceç±»å‹" tabindex="-1"><a class="header-anchor" href="#kubernetes-serviceç±»å‹" aria-hidden="true">#</a> Kubernetes Serviceç±»å‹ï¼Ÿ</h3><p>é€šè¿‡åˆ›å»ºServiceï¼Œå¯ä»¥ä¸ºä¸€ç»„å…·æœ‰ç›¸åŒåŠŸèƒ½çš„å®¹å™¨åº”ç”¨æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£åœ°å€ï¼Œå¹¶ä¸”å°†è¯·æ±‚è´Ÿè½½åˆ†å‘åˆ°åç«¯çš„å„ä¸ªå®¹å™¨åº”ç”¨ä¸Šã€‚å…¶ä¸»è¦ç±»å‹æœ‰ï¼š</p><ul><li><p>ClusterIPï¼šè™šæ‹Ÿçš„æœåŠ¡IPåœ°å€ï¼Œè¯¥åœ°å€ç”¨äºKubernetesé›†ç¾¤å†…éƒ¨çš„Podè®¿é—®ï¼Œåœ¨Nodeä¸Škube- proxyé€šè¿‡è®¾ç½®çš„iptablesè§„åˆ™è¿›è¡Œè½¬å‘</p></li><li><p>NodePortï¼šä½¿ç”¨å®¿ä¸»æœºçš„ç«¯å£ï¼Œä½¿èƒ½å¤Ÿè®¿é—®å„Nodeçš„å¤–éƒ¨å®¢æˆ·ç«¯é€šè¿‡Nodeçš„IPåœ°å€å’Œç«¯å£å·å°±èƒ½è®¿é—®æœåŠ¡</p></li><li><p>LoadBalancerï¼šä½¿ç”¨å¤–æ¥è´Ÿè½½å‡è¡¡å™¨å®Œæˆåˆ°æœåŠ¡çš„è´Ÿè½½åˆ†å‘ï¼Œéœ€è¦åœ¨spec.status.loadBalancerå­—æ®µæŒ‡å®šå¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨çš„IPåœ°å€ï¼Œé€šå¸¸ç”¨äºå…¬æœ‰äº‘</p></li></ul><h3 id="kubernetes-serviceåˆ†å‘åç«¯çš„ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#kubernetes-serviceåˆ†å‘åç«¯çš„ç­–ç•¥" aria-hidden="true">#</a> Kubernetes Serviceåˆ†å‘åç«¯çš„ç­–ç•¥ï¼Ÿ</h3><ul><li><p>Serviceè´Ÿè½½åˆ†å‘çš„ç­–ç•¥æœ‰ï¼šRoundRobinå’ŒSessionAffinity</p></li><li><p>RoundRobinï¼šé»˜è®¤ä¸ºè½®è¯¢æ¨¡å¼ï¼Œå³è½®è¯¢å°†è¯·æ±‚è½¬å‘åˆ°åç«¯çš„å„ä¸ªPodä¸Š</p></li><li><p>SessionAffinityï¼šåŸºäºå®¢æˆ·ç«¯IPåœ°å€è¿›è¡Œä¼šè¯ä¿æŒçš„æ¨¡å¼ï¼Œå³ç¬¬1æ¬¡å°†æŸä¸ªå®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚è½¬å‘åˆ°åç«¯çš„æŸä¸ªPodä¸Šï¼Œä¹‹åä»ç›¸åŒçš„å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚éƒ½å°†è¢«è½¬å‘åˆ°åç«¯ç›¸åŒçš„Podä¸Š</p></li></ul><h3 id="kubernetes-headless-service" tabindex="-1"><a class="header-anchor" href="#kubernetes-headless-service" aria-hidden="true">#</a> Kubernetes Headless Serviceï¼Ÿ</h3><p>åœ¨æŸäº›åº”ç”¨åœºæ™¯ä¸­ï¼Œè‹¥éœ€è¦äººä¸ºæŒ‡å®šè´Ÿè½½å‡è¡¡å™¨ï¼Œä¸ä½¿ç”¨Serviceæä¾›çš„é»˜è®¤è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œæˆ–è€…åº”ç”¨ç¨‹åºå¸Œæœ›çŸ¥é“å±äºåŒç»„æœåŠ¡çš„å…¶ä»–å®ä¾‹ã€‚Kubernetesæä¾›äº†Headless Serviceæ¥å®ç°è¿™ç§åŠŸèƒ½ï¼Œå³ä¸ä¸ºServiceè®¾ç½®ClusterIP(å…¥å£IPåœ°å€ï¼‰ï¼Œä»…é€šè¿‡Label Selectorå°†åç«¯çš„Podåˆ—è¡¨è¿”å›ç»™è°ƒç”¨çš„å®¢æˆ·ç«¯ã€‚</p><h3 id="kuberneteså¤–éƒ¨å¦‚ä½•è®¿é—®é›†ç¾¤å†…çš„æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#kuberneteså¤–éƒ¨å¦‚ä½•è®¿é—®é›†ç¾¤å†…çš„æœåŠ¡" aria-hidden="true">#</a> Kuberneteså¤–éƒ¨å¦‚ä½•è®¿é—®é›†ç¾¤å†…çš„æœåŠ¡ï¼Ÿ</h3><p>å¯¹äºKubernetesï¼Œé›†ç¾¤å¤–çš„å®¢æˆ·ç«¯é»˜è®¤æƒ…å†µï¼Œæ— æ³•é€šè¿‡Podçš„IPåœ°å€æˆ–è€…Serviceçš„è™šæ‹ŸIPåœ°å€ï¼šè™šæ‹Ÿç«¯å£ å·è¿›è¡Œè®¿é—®ã€‚é€šå¸¸å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œè®¿é—®Kubernetesé›†ç¾¤å†…çš„æœåŠ¡ï¼š</p><ul><li><p>æ˜ å°„Podåˆ°ç‰©ç†æœºï¼šå°†Podç«¯å£å·æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œå³åœ¨Podä¸­é‡‡ç”¨hostPortæ–¹å¼ï¼Œä»¥ä½¿å®¢æˆ·ç«¯åº”ç”¨èƒ½å¤Ÿé€šè¿‡ç‰©ç†æœºè®¿é—®å®¹å™¨åº”ç”¨ã€‚</p></li><li><p>æ˜ å°„Serviceåˆ°ç‰©ç†æœºï¼šå°†Serviceç«¯å£å·æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œå³åœ¨Serviceä¸­é‡‡ç”¨nodePortæ–¹å¼ï¼Œä»¥ä½¿å®¢æˆ·ç«¯ åº”ç”¨èƒ½å¤Ÿé€šè¿‡ç‰©ç†æœºè®¿é—®å®¹å™¨åº”ç”¨ã€‚</p></li><li><p>æ˜ å°„Sercieåˆ°LoadBalancerï¼šé€šè¿‡è®¾ç½®LoadBalanceræ˜ å°„åˆ°äº‘æœåŠ¡å•†æä¾›çš„LoadBalanceråœ°å€ã€‚è¿™ç§ ç”¨æ³•ä»…ç”¨äºåœ¨å…¬æœ‰äº‘æœåŠ¡æä¾›å•†çš„äº‘å¹³å°ä¸Šè®¾ç½®Serviceçš„åœºæ™¯ã€‚</p></li></ul><h3 id="kubernetes-ingress" tabindex="-1"><a class="header-anchor" href="#kubernetes-ingress" aria-hidden="true">#</a> Kubernetes ingressï¼Ÿ</h3><p>Kubernetesçš„Ingressèµ„æºå¯¹è±¡ï¼Œç”¨äºå°†ä¸åŒURLçš„è®¿é—®è¯·æ±‚è½¬å‘åˆ°åç«¯ä¸åŒçš„Serviceï¼Œä»¥å®ç°HTTPå±‚çš„ä¸šåŠ¡è·¯ç”±æœºåˆ¶ã€‚</p><p>Kubernetesä½¿ç”¨äº†Ingressç­–ç•¥å’ŒIngress Controllerï¼Œä¸¤è€…ç»“åˆå¹¶å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„Ingressè´Ÿè½½å‡è¡¡å™¨ã€‚ä½¿ç”¨Ingressè¿›è¡Œè´Ÿè½½åˆ†å‘æ—¶ï¼ŒIngress ControlleråŸºäºIngressè§„åˆ™å°†å®¢æˆ·ç«¯è¯·æ±‚ç›´æ¥è½¬å‘åˆ°Service å¯¹åº”çš„åç«¯Endpoint(Podï¼‰ä¸Šï¼Œä»è€Œè·³è¿‡kube-proxyçš„è½¬å‘åŠŸèƒ½ï¼Œkube-proxyä¸å†èµ·ä½œç”¨ï¼Œå…¨è¿‡ç¨‹ä¸ºï¼šingress controller + ingress è§„åˆ™ &gt; servicesã€‚</p><p>åŒæ—¶å½“Ingress Controlleræä¾›çš„æ˜¯å¯¹å¤–æœåŠ¡ï¼Œåˆ™å®é™…ä¸Šå®ç°çš„æ˜¯è¾¹ç¼˜è·¯ç”±å™¨çš„åŠŸèƒ½ã€‚</p><h3 id="kubernetesçš„è´Ÿè½½å‡è¡¡å™¨" tabindex="-1"><a class="header-anchor" href="#kubernetesçš„è´Ÿè½½å‡è¡¡å™¨" aria-hidden="true">#</a> Kubernetesçš„è´Ÿè½½å‡è¡¡å™¨ï¼Ÿ</h3><p>è´Ÿè½½å‡è¡¡å™¨æ˜¯æš´éœ²æœåŠ¡çš„æœ€å¸¸è§å’Œæ ‡å‡†æ–¹å¼ä¹‹ä¸€ã€‚ æ ¹æ®å·¥ä½œç¯å¢ƒä½¿ç”¨ä¸¤ç§ç±»å‹çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œå³å†…éƒ¨è´Ÿè½½å‡è¡¡å™¨æˆ–å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨ã€‚å†…éƒ¨è´Ÿè½½å‡è¡¡å™¨è‡ªåŠ¨ å¹³è¡¡è´Ÿè½½å¹¶ä½¿ç”¨æ‰€éœ€é…ç½®åˆ†é…å®¹å™¨ï¼Œè€Œå¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨å°†æµé‡ä»å¤–éƒ¨è´Ÿè½½å¼•å¯¼è‡³åç«¯å®¹å™¨ã€‚</p><h3 id="kuberneteså„æ¨¡å—å¦‚ä½•ä¸api-serveré€šä¿¡" tabindex="-1"><a class="header-anchor" href="#kuberneteså„æ¨¡å—å¦‚ä½•ä¸api-serveré€šä¿¡" aria-hidden="true">#</a> Kuberneteså„æ¨¡å—å¦‚ä½•ä¸API Serveré€šä¿¡ï¼Ÿ</h3><p>Kubernetes API Serverä½œä¸ºé›†ç¾¤çš„æ ¸å¿ƒï¼Œè´Ÿè´£é›†ç¾¤å„åŠŸèƒ½æ¨¡å—ä¹‹é—´çš„é€šä¿¡ã€‚é›†ç¾¤å†…çš„å„ä¸ªåŠŸèƒ½æ¨¡å—é€šè¿‡API Serverå°†ä¿¡æ¯å­˜å…¥etcdï¼Œå½“éœ€è¦è·å–å’Œæ“ä½œè¿™äº›æ•°æ®æ—¶ï¼Œåˆ™é€šè¿‡API Serveræä¾›çš„RESTæ¥å£(ç”¨GETã€LISTæˆ–WATCHæ–¹æ³•ï¼‰æ¥å®ç°ï¼Œä»è€Œå®ç°å„æ¨¡å—ä¹‹é—´çš„ä¿¡æ¯äº¤äº’ã€‚ å¦‚kubeletè¿›ç¨‹ä¸API Serverçš„äº¤äº’ï¼šæ¯ä¸ªNodeä¸Šçš„kubeletæ¯éš”ä¸€ä¸ªæ—¶é—´å‘¨æœŸï¼Œå°±ä¼šè°ƒç”¨ä¸€æ¬¡API Serverçš„RESTæ¥å£æŠ¥å‘Šè‡ªèº«çŠ¶æ€ï¼ŒAPI Serveråœ¨æ¥æ”¶åˆ°è¿™äº›ä¿¡æ¯åï¼Œä¼šå°†èŠ‚ç‚¹çŠ¶æ€ä¿¡æ¯æ›´æ–°åˆ°etcdä¸­ã€‚ å¦‚kube-controller-managerè¿›ç¨‹ä¸API Serverçš„äº¤äº’ï¼škube-controller-managerä¸­çš„Node Controller æ¨¡å—é€šè¿‡API Serveræä¾›çš„Watchæ¥å£å®æ—¶ç›‘æ§Nodeçš„ä¿¡æ¯ï¼Œå¹¶åšç›¸åº”å¤„ç†ã€‚ å¦‚kube-schedulerè¿›ç¨‹ä¸API Serverçš„äº¤äº’ï¼šScheduleré€šè¿‡API Serverçš„Watchæ¥å£ç›‘å¬åˆ°æ–°å»ºPodå‰¯æœ¬çš„ä¿¡æ¯åï¼Œä¼šæ£€ç´¢æ‰€æœ‰ç¬¦åˆè¯¥Podè¦æ±‚çš„Nodeåˆ—è¡¨ï¼Œå¼€å§‹æ‰§è¡ŒPodè°ƒåº¦é€»è¾‘ï¼Œåœ¨è°ƒåº¦æˆåŠŸåå°†Podç»‘å®šåˆ°ç›®æ ‡èŠ‚ç‚¹ä¸Šã€‚</p><h3 id="kubernetes-schedulerä½œç”¨åŠå®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#kubernetes-schedulerä½œç”¨åŠå®ç°åŸç†" aria-hidden="true">#</a> Kubernetes Schedulerä½œç”¨åŠå®ç°åŸç†ï¼Ÿ</h3><p>Kubernetes Scheduleræ˜¯è´Ÿè´£Podè°ƒåº¦çš„é‡è¦åŠŸèƒ½æ¨¡å—ï¼ŒKubernetes Scheduleråœ¨æ•´ä¸ªç³»ç»Ÿä¸­æ‰¿æ‹…äº†â€œæ‰¿ä¸Šå¯ä¸‹â€çš„é‡è¦åŠŸèƒ½ï¼Œâ€œæ‰¿ä¸Šâ€æ˜¯æŒ‡å®ƒè´Ÿè´£æ¥æ”¶Controller Manageråˆ›å»ºçš„æ–°Podï¼Œä¸ºå…¶è°ƒåº¦è‡³ç›®æ ‡ Nodeï¼›â€œå¯ä¸‹â€æ˜¯æŒ‡è°ƒåº¦å®Œæˆåï¼Œç›®æ ‡Nodeä¸Šçš„kubeletæœåŠ¡è¿›ç¨‹æ¥ç®¡åç»§å·¥ä½œï¼Œè´Ÿè´£Podæ¥ä¸‹æ¥ç”Ÿå‘½å‘¨ æœŸã€‚ Kubernetes Schedulerçš„ä½œç”¨æ˜¯å°†å¾…è°ƒåº¦çš„Pod(APIæ–°åˆ›å»ºçš„Podã€Controller Managerä¸ºè¡¥è¶³å‰¯æœ¬è€Œåˆ›å»ºçš„Podç­‰ï¼‰æŒ‰ç…§ç‰¹å®šçš„è°ƒåº¦ç®—æ³•å’Œè°ƒåº¦ç­–ç•¥ç»‘å®š(Bindingï¼‰åˆ°é›†ç¾¤ä¸­æŸä¸ªåˆé€‚çš„Nodeä¸Šï¼Œå¹¶å°†ç»‘å®šä¿¡æ¯å†™å…¥etcdä¸­ã€‚ åœ¨æ•´ä¸ªè°ƒåº¦è¿‡ç¨‹ä¸­æ¶‰åŠä¸‰ä¸ªå¯¹è±¡ï¼Œåˆ†åˆ«æ˜¯å¾…è°ƒåº¦Podåˆ—è¡¨ã€å¯ç”¨Nodeåˆ—è¡¨ï¼Œä»¥åŠè°ƒåº¦ç®—æ³•å’Œç­–ç•¥ã€‚</p><p>Kubernetes Scheduleré€šè¿‡è°ƒåº¦ç®—æ³•è°ƒåº¦ä¸ºå¾…è°ƒåº¦Podåˆ—è¡¨ä¸­çš„æ¯ä¸ªPodä»Nodeåˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªæœ€é€‚åˆçš„Nodeæ¥å®ç°Podçš„è°ƒåº¦ã€‚éšåï¼Œç›®æ ‡èŠ‚ç‚¹ä¸Šçš„kubeleté€šè¿‡API Serverç›‘å¬åˆ°Kubernetes Scheduler äº§ç”Ÿçš„Podç»‘å®šäº‹ä»¶ï¼Œç„¶åè·å–å¯¹åº”çš„Podæ¸…å•ï¼Œä¸‹è½½Imageé•œåƒå¹¶å¯åŠ¨å®¹å™¨ã€‚</p><h3 id="kubernetes-schedulerä½¿ç”¨å“ªä¸¤ç§ç®—æ³•å°†podç»‘å®šåˆ°workerèŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#kubernetes-schedulerä½¿ç”¨å“ªä¸¤ç§ç®—æ³•å°†podç»‘å®šåˆ°workerèŠ‚ç‚¹" aria-hidden="true">#</a> Kubernetes Schedulerä½¿ç”¨å“ªä¸¤ç§ç®—æ³•å°†Podç»‘å®šåˆ°workerèŠ‚ç‚¹ï¼Ÿ</h3><p>Kubernetes Scheduleræ ¹æ®å¦‚ä¸‹ä¸¤ç§è°ƒåº¦ç®—æ³•å°† Pod ç»‘å®šåˆ°æœ€åˆé€‚çš„å·¥ä½œèŠ‚ç‚¹ï¼š é¢„é€‰(Predicatesï¼‰ï¼šè¾“å…¥æ˜¯æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¾“å‡ºæ˜¯æ»¡è¶³é¢„é€‰æ¡ä»¶çš„èŠ‚ç‚¹ã€‚kube-scheduleræ ¹æ®é¢„é€‰ç­–ç•¥è¿‡æ»¤æ‰ä¸æ»¡è¶³ç­–ç•¥çš„Nodesã€‚å¦‚æœæŸèŠ‚ç‚¹çš„èµ„æºä¸è¶³æˆ–è€…ä¸æ»¡è¶³é¢„é€‰ç­–ç•¥çš„æ¡ä»¶åˆ™æ— æ³•é€šè¿‡é¢„é€‰ã€‚å¦‚ â€œNodeçš„labelå¿…é¡»ä¸Podçš„Selectorä¸€è‡´â€ã€‚ ä¼˜é€‰(Prioritiesï¼‰ï¼šè¾“å…¥æ˜¯é¢„é€‰é˜¶æ®µç­›é€‰å‡ºçš„èŠ‚ç‚¹ï¼Œä¼˜é€‰ä¼šæ ¹æ®ä¼˜å…ˆç­–ç•¥ä¸ºé€šè¿‡é¢„é€‰çš„Nodesè¿›è¡Œæ‰“åˆ† æ’åï¼Œé€‰æ‹©å¾—åˆ†æœ€é«˜çš„Nodeã€‚ä¾‹å¦‚ï¼Œèµ„æºè¶Šå¯Œè£•ã€è´Ÿè½½è¶Šå°çš„Nodeå¯èƒ½å…·æœ‰è¶Šé«˜çš„æ’åã€‚</p><h3 id="kubernetes-kubeletçš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#kubernetes-kubeletçš„ä½œç”¨" aria-hidden="true">#</a> Kubernetes kubeletçš„ä½œç”¨ï¼Ÿ</h3><p>åœ¨Kubernetesé›†ç¾¤ä¸­ï¼Œåœ¨æ¯ä¸ªNode(åˆç§°Workerï¼‰ä¸Šéƒ½ä¼šå¯åŠ¨ä¸€ä¸ªkubeletæœåŠ¡è¿›ç¨‹ã€‚è¯¥è¿›ç¨‹ç”¨äºå¤„ ç†Masterä¸‹å‘åˆ°æœ¬èŠ‚ç‚¹çš„ä»»åŠ¡ï¼Œç®¡ç†PodåŠPodä¸­çš„å®¹å™¨ã€‚æ¯ä¸ªkubeletè¿›ç¨‹éƒ½ä¼šåœ¨API Serverä¸Šæ³¨å†ŒèŠ‚ç‚¹è‡ªèº«çš„ä¿¡æ¯ï¼Œå®šæœŸå‘Masteræ±‡æŠ¥èŠ‚ç‚¹èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œå¹¶é€šè¿‡cAdvisorç›‘æ§å®¹å™¨å’ŒèŠ‚ç‚¹èµ„æºã€‚</p><h3 id="kubernetes-kubeletç›‘æ§workerèŠ‚ç‚¹èµ„æºæ˜¯ä½¿ç”¨ä»€ä¹ˆç»„ä»¶æ¥å®ç°çš„" tabindex="-1"><a class="header-anchor" href="#kubernetes-kubeletç›‘æ§workerèŠ‚ç‚¹èµ„æºæ˜¯ä½¿ç”¨ä»€ä¹ˆç»„ä»¶æ¥å®ç°çš„" aria-hidden="true">#</a> Kubernetes kubeletç›‘æ§WorkerèŠ‚ç‚¹èµ„æºæ˜¯ä½¿ç”¨ä»€ä¹ˆç»„ä»¶æ¥å®ç°çš„ï¼Ÿ</h3><p>kubeletä½¿ç”¨cAdvisorå¯¹workerèŠ‚ç‚¹èµ„æºè¿›è¡Œç›‘æ§ã€‚åœ¨ Kubernetes ç³»ç»Ÿä¸­ï¼ŒcAdvisor å·²è¢«é»˜è®¤é›†æˆåˆ°kubelet ç»„ä»¶å†…ï¼Œå½“ kubelet æœåŠ¡å¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å¯åŠ¨ cAdvisor æœåŠ¡ï¼Œç„¶å cAdvisor ä¼šå®æ—¶é‡‡é›†æ‰€åœ¨èŠ‚ç‚¹çš„æ€§èƒ½æŒ‡æ ‡åŠåœ¨èŠ‚ç‚¹ä¸Šè¿è¡Œçš„å®¹å™¨çš„æ€§èƒ½æŒ‡æ ‡ã€‚</p><h3 id="kuberneteså¦‚ä½•ä¿è¯é›†ç¾¤çš„å®‰å…¨æ€§" tabindex="-1"><a class="header-anchor" href="#kuberneteså¦‚ä½•ä¿è¯é›†ç¾¤çš„å®‰å…¨æ€§" aria-hidden="true">#</a> Kuberneteså¦‚ä½•ä¿è¯é›†ç¾¤çš„å®‰å…¨æ€§ï¼Ÿ</h3><p>Kubernetesé€šè¿‡ä¸€ç³»åˆ—æœºåˆ¶æ¥å®ç°é›†ç¾¤çš„å®‰å…¨æ§åˆ¶ï¼Œä¸»è¦æœ‰å¦‚ä¸‹ä¸åŒçš„ç»´åº¦ï¼š åŸºç¡€è®¾æ–½æ–¹é¢ï¼šä¿è¯å®¹å™¨ä¸å…¶æ‰€åœ¨å®¿ä¸»æœºçš„éš”ç¦»ï¼› æƒé™æ–¹é¢ï¼š æœ€å°æƒé™åŸåˆ™ï¼šåˆç†é™åˆ¶æ‰€æœ‰ç»„ä»¶çš„æƒé™ï¼Œç¡®ä¿ç»„ä»¶åªæ‰§è¡Œå®ƒè¢«æˆæƒçš„è¡Œä¸ºï¼Œé€šè¿‡é™åˆ¶å•ä¸ªç»„ä»¶çš„ èƒ½åŠ›æ¥é™åˆ¶å®ƒçš„æƒé™èŒƒå›´ã€‚ ç”¨æˆ·æƒé™ï¼šåˆ’åˆ†æ™®é€šç”¨æˆ·å’Œç®¡ç†å‘˜çš„è§’è‰²ã€‚é›†ç¾¤æ–¹é¢ï¼š API Serverçš„è®¤è¯æˆæƒï¼šKubernetesé›†ç¾¤ä¸­æ‰€æœ‰èµ„æºçš„è®¿é—®å’Œå˜æ›´éƒ½æ˜¯é€šè¿‡Kubernetes API Serveræ¥å®ç°çš„ï¼Œå› æ­¤éœ€è¦å»ºè®®é‡‡ç”¨æ›´å®‰å…¨çš„HTTPSæˆ–Tokenæ¥è¯†åˆ«å’Œè®¤è¯å®¢æˆ·ç«¯èº«ä»½ (Authenticationï¼‰ï¼Œä»¥åŠéšåè®¿é—®æƒé™çš„æˆæƒ(Authorizationï¼‰ç¯èŠ‚ã€‚ API Serverçš„æˆæƒç®¡ç†ï¼šé€šè¿‡æˆæƒç­–ç•¥æ¥å†³å®šä¸€ä¸ªAPIè°ƒç”¨æ˜¯å¦åˆæ³•ã€‚å¯¹åˆæ³•ç”¨æˆ·è¿›è¡Œæˆæƒå¹¶ä¸”éšååœ¨ç”¨æˆ·è®¿é—®æ—¶è¿›è¡Œé‰´æƒï¼Œå»ºè®®é‡‡ç”¨æ›´å®‰å…¨çš„RBACæ–¹å¼æ¥æå‡é›†ç¾¤å®‰å…¨æˆæƒã€‚ æ•æ„Ÿæ•°æ®å¼•å…¥Secretæœºåˆ¶ï¼šå¯¹äºé›†ç¾¤æ•æ„Ÿæ•°æ®å»ºè®®ä½¿ç”¨Secretæ–¹å¼è¿›è¡Œä¿æŠ¤ã€‚ AdmissionControl(å‡†å…¥æœºåˆ¶ï¼‰ï¼šå¯¹kubernetes apiçš„è¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œé¡ºåºä¸ºï¼šå…ˆç»è¿‡è®¤è¯ &amp; æˆæƒï¼Œç„¶åæ‰§è¡Œå‡†å…¥æ“ä½œï¼Œæœ€åå¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œæ“ä½œã€‚</p><h3 id="kuberneteså‡†å…¥æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#kuberneteså‡†å…¥æœºåˆ¶" aria-hidden="true">#</a> Kuberneteså‡†å…¥æœºåˆ¶ï¼Ÿ</h3><p>åœ¨å¯¹é›†ç¾¤è¿›è¡Œè¯·æ±‚æ—¶ï¼Œæ¯ä¸ªå‡†å…¥æ§åˆ¶ä»£ç éƒ½æŒ‰ç…§ä¸€å®šé¡ºåºæ‰§è¡Œã€‚å¦‚æœæœ‰ä¸€ä¸ªå‡†å…¥æ§åˆ¶æ‹’ç»äº†æ­¤æ¬¡è¯·æ±‚ï¼Œ é‚£ä¹ˆæ•´ä¸ªè¯·æ±‚çš„ç»“æœå°†ä¼šç«‹å³è¿”å›ï¼Œå¹¶æç¤ºç”¨æˆ·ç›¸åº”çš„errorä¿¡æ¯ã€‚ å‡†å…¥æ§åˆ¶(AdmissionControlï¼‰å‡†å…¥æ§åˆ¶æœ¬è´¨ä¸Šä¸ºä¸€æ®µå‡†å…¥ä»£ç ï¼Œåœ¨å¯¹kubernetes apiçš„è¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œ é¡ºåºä¸ºï¼šå…ˆç»è¿‡è®¤è¯ &amp; æˆæƒï¼Œç„¶åæ‰§è¡Œå‡†å…¥æ“ä½œï¼Œæœ€åå¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œæ“ä½œã€‚å¸¸ç”¨ç»„ä»¶(æ§åˆ¶ä»£ç ï¼‰å¦‚ä¸‹ï¼š AlwaysAdmitï¼š å… è®¸ æ‰€ æœ‰ è¯· æ±‚ AlwaysDenyï¼šç¦æ­¢æ‰€æœ‰è¯·æ±‚ï¼Œå¤šç”¨äºæµ‹è¯•ç¯å¢ƒã€‚ ServiceAccountï¼šå®ƒå°†serviceAccountså®ç°äº†è‡ªåŠ¨åŒ–ï¼Œå®ƒä¼šè¾…åŠ©serviceAccountåšä¸€äº›äº‹æƒ…ï¼Œæ¯” å¦‚å¦‚æœpodæ²¡æœ‰serviceAccountå±æ€§ï¼Œå®ƒä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªdefaultï¼Œå¹¶ç¡®ä¿podçš„serviceAccountå§‹ ç»ˆå­˜åœ¨ã€‚ LimitRangerï¼šè§‚å¯Ÿæ‰€æœ‰çš„è¯·æ±‚ï¼Œç¡®ä¿æ²¡æœ‰è¿åå·²ç»å®šä¹‰å¥½çš„çº¦æŸæ¡ä»¶ï¼Œè¿™äº›æ¡ä»¶å®šä¹‰åœ¨namespace ä¸­ LimitRange å¯¹ è±¡ ä¸­ ã€‚ NamespaceExistsï¼šè§‚å¯Ÿæ‰€æœ‰çš„è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚å°è¯•åˆ›å»ºä¸€ä¸ªä¸å­˜åœ¨çš„namespaceï¼Œåˆ™è¿™ä¸ªè¯·æ±‚è¢«æ‹’ç»ã€‚</p><h3 id="kubernetes-rbacåŠå…¶ç‰¹ç‚¹-ä¼˜åŠ¿" tabindex="-1"><a class="header-anchor" href="#kubernetes-rbacåŠå…¶ç‰¹ç‚¹-ä¼˜åŠ¿" aria-hidden="true">#</a> Kubernetes RBACåŠå…¶ç‰¹ç‚¹(ä¼˜åŠ¿ï¼‰ï¼Ÿ</h3><p>RBACæ˜¯åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼Œæ˜¯ä¸€ç§åŸºäºä¸ªäººç”¨æˆ·çš„è§’è‰²æ¥ç®¡ç†å¯¹è®¡ç®—æœºæˆ–ç½‘ç»œèµ„æºçš„è®¿é—®çš„æ–¹æ³•ã€‚ç›¸å¯¹äºå…¶ä»–æˆæƒæ¨¡å¼ï¼ŒRBACå…·æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š å¯¹é›†ç¾¤ä¸­çš„èµ„æºå’Œéèµ„æºæƒé™å‡æœ‰å®Œæ•´çš„è¦†ç›–ã€‚ æ•´ä¸ªRBACå®Œå…¨ç”±å‡ ä¸ªAPIå¯¹è±¡å®Œæˆï¼Œ åŒå…¶ä»–APIå¯¹è±¡ä¸€æ ·ï¼Œ å¯ä»¥ç”¨kubectlæˆ–APIè¿›è¡Œæ“ä½œã€‚å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œè°ƒæ•´ï¼Œæ— é¡»é‡æ–°å¯åŠ¨API Serverã€‚</p><h3 id="kubernetes-secretä½œç”¨" tabindex="-1"><a class="header-anchor" href="#kubernetes-secretä½œç”¨" aria-hidden="true">#</a> Kubernetes Secretä½œç”¨ï¼Ÿ</h3><p>Secretå¯¹è±¡ï¼Œä¸»è¦ä½œç”¨æ˜¯ä¿ç®¡ç§å¯†æ•°æ®ï¼Œæ¯”å¦‚å¯†ç ã€OAuth Tokensã€SSH Keysç­‰ä¿¡æ¯ã€‚å°†è¿™äº›ç§å¯†ä¿¡æ¯æ”¾åœ¨Secretå¯¹è±¡ä¸­æ¯”ç›´æ¥æ”¾åœ¨Podæˆ–Docker Imageä¸­æ›´å®‰å…¨ï¼Œä¹Ÿæ›´ä¾¿äºä½¿ç”¨å’Œåˆ†å‘ã€‚</p><h3 id="kubernetes-secretæœ‰å“ªäº›ä½¿ç”¨æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#kubernetes-secretæœ‰å“ªäº›ä½¿ç”¨æ–¹å¼" aria-hidden="true">#</a> Kubernetes Secretæœ‰å“ªäº›ä½¿ç”¨æ–¹å¼ï¼Ÿ</h3><p>åˆ›å»ºå®Œsecretä¹‹åï¼Œå¯é€šè¿‡å¦‚ä¸‹ä¸‰ç§æ–¹å¼ä½¿ç”¨ï¼š åœ¨åˆ›å»ºPodæ—¶ï¼Œé€šè¿‡ä¸ºPodæŒ‡å®šService Accountæ¥è‡ªåŠ¨ä½¿ç”¨è¯¥Secretã€‚é€šè¿‡æŒ‚è½½è¯¥Secretåˆ°Podæ¥ä½¿ç”¨å®ƒã€‚ åœ¨Dockeré•œåƒä¸‹è½½æ—¶ä½¿ç”¨ï¼Œé€šè¿‡æŒ‡å®šPodçš„spc.ImagePullSecretsæ¥å¼•ç”¨å®ƒã€‚</p><h3 id="kubernetes-podsecuritypolicyæœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#kubernetes-podsecuritypolicyæœºåˆ¶" aria-hidden="true">#</a> Kubernetes PodSecurityPolicyæœºåˆ¶ï¼Ÿ</h3><p>Kubernetes PodSecurityPolicyæ˜¯ä¸ºäº†æ›´ç²¾ç»†åœ°æ§åˆ¶Podå¯¹èµ„æºçš„ä½¿ç”¨æ–¹å¼ä»¥åŠæå‡å®‰å…¨ç­–ç•¥ã€‚åœ¨å¼€å¯PodSecurityPolicyå‡†å…¥æ§åˆ¶å™¨åï¼ŒKubernetesé»˜è®¤ä¸å…è®¸åˆ›å»ºä»»ä½•Podï¼Œéœ€è¦åˆ›å»ºPodSecurityPolicy ç­–ç•¥å’Œç›¸åº”çš„RBACæˆæƒç­–ç•¥(Authorizing Policiesï¼‰ï¼ŒPodæ‰èƒ½åˆ›å»ºæˆåŠŸã€‚</p><h3 id="kubernetes-podsecuritypolicyæœºåˆ¶èƒ½å®ç°å“ªäº›å®‰å…¨ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#kubernetes-podsecuritypolicyæœºåˆ¶èƒ½å®ç°å“ªäº›å®‰å…¨ç­–ç•¥" aria-hidden="true">#</a> Kubernetes PodSecurityPolicyæœºåˆ¶èƒ½å®ç°å“ªäº›å®‰å…¨ç­–ç•¥ï¼Ÿ</h3><p>åœ¨PodSecurityPolicyå¯¹è±¡ä¸­å¯ä»¥è®¾ç½®ä¸åŒå­—æ®µæ¥æ§åˆ¶Podè¿è¡Œæ—¶çš„å„ç§å®‰å…¨ç­–ç•¥ï¼Œå¸¸è§çš„æœ‰ï¼š ç‰¹æƒæ¨¡å¼ï¼šprivilegedæ˜¯å¦å…è®¸Podä»¥ç‰¹æƒæ¨¡å¼è¿è¡Œã€‚ å®¿ä¸»æœºèµ„æºï¼šæ§åˆ¶Podå¯¹å®¿ä¸»æœºèµ„æºçš„æ§åˆ¶ï¼Œå¦‚hostPIDï¼šæ˜¯å¦å…è®¸Podå…±äº«å®¿ä¸»æœºçš„è¿›ç¨‹ç©ºé—´ã€‚ ç”¨æˆ·å’Œç»„ï¼šè®¾ç½®è¿è¡Œå®¹å™¨çš„ç”¨æˆ·ID(èŒƒå›´ï¼‰æˆ–ç»„(èŒƒå›´ï¼‰ã€‚ æå‡æƒé™ï¼šAllowPrivilegeEscalationï¼šè®¾ç½®å®¹å™¨å†…çš„å­è¿›ç¨‹æ˜¯å¦å¯ä»¥æå‡æƒé™ï¼Œé€šå¸¸åœ¨è®¾ç½®éroot ç”¨æˆ·(MustRunAsNonRootï¼‰æ—¶è¿›è¡Œè®¾ç½®ã€‚</p><p>SELinuxï¼šè¿›è¡ŒSELinuxçš„ç›¸å…³é…ç½®ã€‚</p><h3 id="kubernetesç½‘ç»œæ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#kubernetesç½‘ç»œæ¨¡å‹" aria-hidden="true">#</a> Kubernetesç½‘ç»œæ¨¡å‹ï¼Ÿ</h3><p>Kubernetesç½‘ç»œæ¨¡å‹ä¸­æ¯ä¸ªPodéƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„IPåœ°å€ï¼Œå¹¶å‡å®šæ‰€æœ‰Podéƒ½åœ¨ä¸€ä¸ªå¯ä»¥ç›´æ¥è¿é€šçš„ã€ æ‰å¹³çš„ç½‘ç»œç©ºé—´ä¸­ã€‚æ‰€ä»¥ä¸ç®¡å®ƒä»¬æ˜¯å¦è¿è¡Œåœ¨åŒä¸€ä¸ªNode(å®¿ä¸»æœºï¼‰ä¸­ï¼Œéƒ½è¦æ±‚å®ƒä»¬å¯ä»¥ç›´æ¥é€šè¿‡å¯¹æ–¹ çš„IPè¿›è¡Œè®¿é—®ã€‚è®¾è®¡è¿™ä¸ªåŸåˆ™çš„åŸå› æ˜¯ï¼Œç”¨æˆ·ä¸éœ€è¦é¢å¤–è€ƒè™‘å¦‚ä½•å»ºç«‹Podä¹‹é—´çš„è¿æ¥ï¼Œä¹Ÿä¸éœ€è¦è€ƒè™‘ å¦‚ä½•å°†å®¹å™¨ç«¯å£æ˜ å°„åˆ°ä¸»æœºç«¯å£ç­‰é—®é¢˜ã€‚ åŒæ—¶ä¸ºæ¯ä¸ªPodéƒ½è®¾ç½®ä¸€ä¸ªIPåœ°å€çš„æ¨¡å‹ä½¿å¾—åŒä¸€ä¸ªPodå†…çš„ä¸åŒå®¹å™¨ä¼šå…±äº«åŒä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ä¸ªLinuxç½‘ç»œåè®®æ ˆã€‚è¿™å°±æ„å‘³ç€åŒä¸€ä¸ªPodå†…çš„å®¹å™¨å¯ä»¥é€šè¿‡localhostæ¥è¿æ¥å¯¹æ–¹çš„ç«¯å£ã€‚ åœ¨Kubernetesçš„é›†ç¾¤é‡Œï¼ŒIPæ˜¯ä»¥Podä¸ºå•ä½è¿›è¡Œåˆ†é…çš„ã€‚ä¸€ä¸ªPodå†…éƒ¨çš„æ‰€æœ‰å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œå †æ ˆ (ç›¸å½“äºä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼Œå®ƒä»¬çš„IPåœ°å€ã€ç½‘ç»œè®¾å¤‡ã€é…ç½®ç­‰éƒ½æ˜¯å…±äº«çš„ï¼‰ã€‚</p><h3 id="kubernetes-cniæ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#kubernetes-cniæ¨¡å‹" aria-hidden="true">#</a> Kubernetes CNIæ¨¡å‹ï¼Ÿ</h3><p>CNIæä¾›äº†ä¸€ç§åº”ç”¨å®¹å™¨çš„æ’ä»¶åŒ–ç½‘ç»œè§£å†³æ–¹æ¡ˆï¼Œå®šä¹‰å¯¹å®¹å™¨ç½‘ç»œè¿›è¡Œæ“ä½œå’Œé…ç½®çš„è§„èŒƒï¼Œé€šè¿‡æ’ä»¶çš„å½¢å¼å¯¹CNIæ¥å£è¿›è¡Œå®ç°ã€‚CNIä»…å…³æ³¨åœ¨åˆ›å»ºå®¹å™¨æ—¶åˆ†é…ç½‘ç»œèµ„æºï¼Œå’Œåœ¨é”€æ¯å®¹å™¨æ—¶åˆ é™¤ç½‘ç»œèµ„æºã€‚åœ¨CNIæ¨¡å‹ä¸­åªæ¶‰åŠä¸¤ä¸ªæ¦‚å¿µï¼šå®¹å™¨å’Œç½‘ç»œã€‚ å®¹å™¨(Containerï¼‰ï¼šæ˜¯æ‹¥æœ‰ç‹¬ç«‹Linuxç½‘ç»œå‘½åç©ºé—´çš„ç¯å¢ƒï¼Œä¾‹å¦‚ä½¿ç”¨Dockeræˆ–rktåˆ›å»ºçš„å®¹å™¨ã€‚å®¹å™¨éœ€è¦æ‹¥æœ‰è‡ªå·±çš„Linuxç½‘ç»œå‘½åç©ºé—´ï¼Œè¿™æ˜¯åŠ å…¥ç½‘ç»œçš„å¿…è¦æ¡ä»¶ã€‚ ç½‘ç»œ(Networkï¼‰ï¼šè¡¨ç¤ºå¯ä»¥äº’è¿çš„ä¸€ç»„å®ä½“ï¼Œè¿™äº›å®ä½“æ‹¥æœ‰å„è‡ªç‹¬ç«‹ã€å”¯ä¸€çš„IPåœ°å€ï¼Œå¯ä»¥æ˜¯å®¹å™¨ã€ ç‰©ç†æœºæˆ–è€…å…¶ä»–ç½‘ç»œè®¾å¤‡(æ¯”å¦‚è·¯ç”±å™¨ï¼‰ç­‰ã€‚ å¯¹å®¹å™¨ç½‘ç»œçš„è®¾ç½®å’Œæ“ä½œéƒ½é€šè¿‡æ’ä»¶(Pluginï¼‰è¿›è¡Œå…·ä½“å®ç°ï¼ŒCNIæ’ä»¶åŒ…æ‹¬ä¸¤ç§ç±»å‹ï¼šCNI Pluginå’ŒIPAM(IP Address Managementï¼‰Pluginã€‚CNI Pluginè´Ÿè´£ä¸ºå®¹å™¨é…ç½®ç½‘ç»œèµ„æºï¼ŒIPAM Pluginè´Ÿè´£å¯¹å®¹å™¨çš„IPåœ°å€è¿›è¡Œåˆ†é…å’Œç®¡ç†ã€‚IPAM Pluginä½œä¸ºCNI Pluginçš„ä¸€éƒ¨åˆ†ï¼Œä¸CNI PluginååŒå·¥ä½œã€‚</p><h3 id="kubernetesç½‘ç»œç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#kubernetesç½‘ç»œç­–ç•¥" aria-hidden="true">#</a> Kubernetesç½‘ç»œç­–ç•¥ï¼Ÿ</h3><p>ä¸ºå®ç°ç»†ç²’åº¦çš„å®¹å™¨é—´ç½‘ç»œè®¿é—®éš”ç¦»ç­–ç•¥ï¼ŒKuberneteså¼•å…¥Network Policyã€‚ Network Policyçš„ä¸»è¦åŠŸèƒ½æ˜¯å¯¹Podé—´çš„ç½‘ç»œé€šä¿¡è¿›è¡Œé™åˆ¶å’Œå‡†å…¥æ§åˆ¶ï¼Œè®¾ç½®å…è®¸è®¿é—®æˆ–ç¦æ­¢è®¿é—®çš„å®¢æˆ·ç«¯Podåˆ—è¡¨ã€‚Network Policyå®šä¹‰ç½‘ç»œç­–ç•¥ï¼Œé…åˆç­–ç•¥æ§åˆ¶å™¨(Policy Controllerï¼‰è¿›è¡Œç­–ç•¥çš„å®ç°ã€‚</p><h3 id="kubernetesç½‘ç»œç­–ç•¥åŸç†" tabindex="-1"><a class="header-anchor" href="#kubernetesç½‘ç»œç­–ç•¥åŸç†" aria-hidden="true">#</a> Kubernetesç½‘ç»œç­–ç•¥åŸç†ï¼Ÿ</h3><p>Network Policyçš„å·¥ä½œåŸç†ä¸»è¦ä¸ºï¼špolicy controlleréœ€è¦å®ç°ä¸€ä¸ªAPI Listenerï¼Œç›‘å¬ç”¨æˆ·è®¾ç½®çš„Network Policyå®šä¹‰ï¼Œå¹¶å°†ç½‘ç»œè®¿é—®è§„åˆ™é€šè¿‡å„Nodeçš„Agentè¿›è¡Œå®é™…è®¾ç½®(Agentåˆ™éœ€è¦é€šè¿‡CNIç½‘ç»œæ’ä»¶å®ç°ï¼‰ã€‚</p><h3 id="kubernetesä¸­flannelçš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#kubernetesä¸­flannelçš„ä½œç”¨" aria-hidden="true">#</a> Kubernetesä¸­flannelçš„ä½œç”¨ï¼Ÿ</h3><p>Flannelå¯ä»¥ç”¨äºKubernetesåº•å±‚ç½‘ç»œçš„å®ç°ï¼Œä¸»è¦ä½œç”¨æœ‰ï¼š å®ƒèƒ½ååŠ©Kubernetesï¼Œç»™æ¯ä¸€ä¸ªNodeä¸Šçš„Dockerå®¹å™¨éƒ½åˆ†é…äº’ç›¸ä¸å†²çªçš„IPåœ°å€ã€‚ å®ƒèƒ½åœ¨è¿™äº›IPåœ°å€ä¹‹é—´å»ºç«‹ä¸€ä¸ªè¦†ç›–ç½‘ç»œ(Overlay Networkï¼‰ï¼Œé€šè¿‡è¿™ä¸ªè¦†ç›–ç½‘ç»œï¼Œå°†æ•°æ®åŒ…åŸå°ä¸åŠ¨åœ°ä¼ é€’åˆ°ç›®æ ‡å®¹å™¨å†…ã€‚ 53ã€Kubernetes Calicoç½‘ç»œç»„ä»¶å®ç°åŸç†ï¼Ÿ Calicoæ˜¯ä¸€ä¸ªåŸºäºBGPçš„çº¯ä¸‰å±‚çš„ç½‘ç»œæ–¹æ¡ˆï¼Œä¸OpenStackã€Kubernetesã€AWSã€GCEç­‰äº‘å¹³å°éƒ½èƒ½å¤Ÿ è‰¯å¥½åœ°é›†æˆã€‚</p><p>Calicoåœ¨æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹éƒ½åˆ©ç”¨Linux Kernelå®ç°äº†ä¸€ä¸ªé«˜æ•ˆçš„vRouteræ¥è´Ÿè´£æ•°æ®è½¬å‘ã€‚æ¯ä¸ªvRouteréƒ½é€šè¿‡BGPåè®®æŠŠåœ¨æœ¬èŠ‚ç‚¹ä¸Šè¿è¡Œçš„å®¹å™¨çš„è·¯ç”±ä¿¡æ¯å‘æ•´ä¸ªCalicoç½‘ç»œå¹¿æ’­ï¼Œå¹¶è‡ªåŠ¨è®¾ç½®åˆ°è¾¾å…¶ä»–èŠ‚ç‚¹çš„è·¯ç”±è½¬å‘è§„åˆ™ã€‚ Calicoä¿è¯æ‰€æœ‰å®¹å™¨ä¹‹é—´çš„æ•°æ®æµé‡éƒ½æ˜¯é€šè¿‡IPè·¯ç”±çš„æ–¹å¼å®Œæˆäº’è”äº’é€šçš„ã€‚CalicoèŠ‚ç‚¹ç»„ç½‘æ—¶å¯ä»¥ç›´æ¥ åˆ©ç”¨æ•°æ®ä¸­å¿ƒçš„ç½‘ç»œç»“æ„(L2æˆ–è€…L3ï¼‰ï¼Œä¸éœ€è¦é¢å¤–çš„NATã€éš§é“æˆ–è€…Overlay Networkï¼Œæ²¡æœ‰é¢å¤–çš„å°åŒ…è§£åŒ…ï¼Œèƒ½å¤ŸèŠ‚çº¦CPUè¿ç®—ï¼Œæé«˜ç½‘ç»œæ•ˆç‡ã€‚</p><h3 id="kuberneteså…±äº«å­˜å‚¨çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#kuberneteså…±äº«å­˜å‚¨çš„ä½œç”¨" aria-hidden="true">#</a> Kuberneteså…±äº«å­˜å‚¨çš„ä½œç”¨ï¼Ÿ</h3><p>Kuberneteså¯¹äºæœ‰çŠ¶æ€çš„å®¹å™¨åº”ç”¨æˆ–è€…å¯¹æ•°æ®éœ€è¦æŒä¹…åŒ–çš„åº”ç”¨ï¼Œå› æ­¤éœ€è¦æ›´åŠ å¯é çš„å­˜å‚¨æ¥ä¿å­˜åº”ç”¨äº§ç”Ÿçš„é‡è¦æ•°æ®ï¼Œä»¥ä¾¿å®¹å™¨åº”ç”¨åœ¨é‡å»ºä¹‹åä»ç„¶å¯ä»¥ä½¿ç”¨ä¹‹å‰çš„æ•°æ®ã€‚å› æ­¤éœ€è¦ä½¿ç”¨å…±äº«å­˜å‚¨ã€‚</p><h3 id="kubernetesæ•°æ®æŒä¹…åŒ–çš„æ–¹å¼æœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#kubernetesæ•°æ®æŒä¹…åŒ–çš„æ–¹å¼æœ‰å“ªäº›" aria-hidden="true">#</a> Kubernetesæ•°æ®æŒä¹…åŒ–çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</h3><p>Kubernetes é€šè¿‡æ•°æ®æŒä¹…åŒ–æ¥æŒä¹…åŒ–ä¿å­˜é‡è¦æ•°æ®ï¼Œå¸¸è§çš„æ–¹å¼æœ‰ï¼š EmptyDir(ç©ºç›®å½•ï¼‰ï¼šæ²¡æœ‰æŒ‡å®šè¦æŒ‚è½½å®¿ä¸»æœºä¸Šçš„æŸä¸ªç›®å½•ï¼Œç›´æ¥ç”±Podå†…ä¿éƒ¨æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šã€‚ç±»ä¼¼ äºdockerä¸­çš„manager volumeã€‚ åœºæ™¯ï¼š åªéœ€è¦ä¸´æ—¶å°†æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œæ¯”å¦‚åœ¨åˆå¹¶/æ’åºç®—æ³•ä¸­ï¼› ä½œä¸ºä¸¤ä¸ªå®¹å™¨çš„å…±äº«å­˜å‚¨ã€‚ ç‰¹æ€§ï¼š åŒä¸ªpodé‡Œé¢çš„ä¸åŒå®¹å™¨ï¼Œå…±äº«åŒä¸€ä¸ªæŒä¹…åŒ–ç›®å½•ï¼Œå½“podèŠ‚ç‚¹åˆ é™¤æ—¶ï¼Œvolumeçš„æ•°æ®ä¹Ÿä¼šè¢«åˆ é™¤ã€‚ emptyDirçš„æ•°æ®æŒä¹…åŒ–çš„ç”Ÿå‘½å‘¨æœŸå’Œä½¿ç”¨çš„podä¸€è‡´ï¼Œä¸€èˆ¬æ˜¯ä½œä¸ºä¸´æ—¶å­˜å‚¨ä½¿ç”¨ã€‚ Hostpathï¼šå°†å®¿ä¸»æœºä¸Šå·²å­˜åœ¨çš„ç›®å½•æˆ–æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨ã€‚ç±»ä¼¼äºdockerä¸­çš„bind mountæŒ‚è½½æ–¹å¼ã€‚ ç‰¹æ€§ï¼šå¢åŠ äº†podä¸èŠ‚ç‚¹ä¹‹é—´çš„è€¦åˆã€‚ PersistentVolume(ç®€ç§°PVï¼‰ï¼šå¦‚åŸºäºNFSæœåŠ¡çš„PVï¼Œä¹Ÿå¯ä»¥åŸºäºGFSçš„PVã€‚å®ƒçš„ä½œç”¨æ˜¯ç»Ÿä¸€æ•°æ®æŒä¹…åŒ–ç›®å½•ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚</p><h3 id="kubernetes-pvå’Œpvc" tabindex="-1"><a class="header-anchor" href="#kubernetes-pvå’Œpvc" aria-hidden="true">#</a> Kubernetes PVå’ŒPVCï¼Ÿ</h3><p>PVæ˜¯å¯¹åº•å±‚ç½‘ç»œå…±äº«å­˜å‚¨çš„æŠ½è±¡ï¼Œå°†å…±äº«å­˜å‚¨å®šä¹‰ä¸ºä¸€ç§â€œèµ„æºâ€ã€‚PVCåˆ™æ˜¯ç”¨æˆ·å¯¹å­˜å‚¨èµ„æºçš„ä¸€ä¸ªâ€œç”³è¯·â€ã€‚</p><h3 id="kubernetes-pvç”Ÿå‘½å‘¨æœŸå†…çš„é˜¶æ®µ" tabindex="-1"><a class="header-anchor" href="#kubernetes-pvç”Ÿå‘½å‘¨æœŸå†…çš„é˜¶æ®µ" aria-hidden="true">#</a> Kubernetes PVç”Ÿå‘½å‘¨æœŸå†…çš„é˜¶æ®µï¼Ÿ</h3><p>æŸä¸ªPVåœ¨ç”Ÿå‘½å‘¨æœŸä¸­å¯èƒ½å¤„äºä»¥ä¸‹4ä¸ªé˜¶æ®µ(Phaesï¼‰ä¹‹ä¸€ã€‚ Availableï¼šå¯ç”¨çŠ¶æ€ï¼Œè¿˜æœªä¸æŸä¸ªPVCç»‘å®šã€‚Boundï¼šå·²ä¸æŸä¸ªPVCç»‘å®šã€‚ Releasedï¼šç»‘å®šçš„PVCå·²ç»åˆ é™¤ï¼Œèµ„æºå·²é‡Šæ”¾ï¼Œä½†æ²¡æœ‰è¢«é›†ç¾¤å›æ”¶ã€‚Failedï¼šè‡ªåŠ¨èµ„æºå›æ”¶å¤±è´¥ã€‚</p><h3 id="kubernetesæ‰€æ”¯æŒçš„å­˜å‚¨ä¾›åº”æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#kubernetesæ‰€æ”¯æŒçš„å­˜å‚¨ä¾›åº”æ¨¡å¼" aria-hidden="true">#</a> Kubernetesæ‰€æ”¯æŒçš„å­˜å‚¨ä¾›åº”æ¨¡å¼ï¼Ÿ</h3><p>Kubernetesæ”¯æŒä¸¤ç§èµ„æºçš„å­˜å‚¨ä¾›åº”æ¨¡å¼ï¼šé™æ€æ¨¡å¼(Staticï¼‰å’ŒåŠ¨æ€æ¨¡å¼(Dynamicï¼‰ã€‚</p><p>é™æ€æ¨¡å¼ï¼šé›†ç¾¤ç®¡ç†å‘˜æ‰‹å·¥åˆ›å»ºè®¸å¤šPVï¼Œåœ¨å®šä¹‰PVæ—¶éœ€è¦å°†åç«¯å­˜å‚¨çš„ç‰¹æ€§è¿›è¡Œè®¾ç½®ã€‚ åŠ¨æ€æ¨¡å¼ï¼šé›†ç¾¤ç®¡ç†å‘˜æ— é¡»æ‰‹å·¥åˆ›å»ºPVï¼Œè€Œæ˜¯é€šè¿‡StorageClassçš„è®¾ç½®å¯¹åç«¯å­˜å‚¨è¿›è¡Œæè¿°ï¼Œæ ‡è®°ä¸ºæŸ ç§ç±»å‹ã€‚æ­¤æ—¶è¦æ±‚PVCå¯¹å­˜å‚¨çš„ç±»å‹è¿›è¡Œå£°æ˜ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å®ŒæˆPVçš„åˆ›å»ºåŠä¸PVCçš„ç»‘å®šã€‚</p><h3 id="kubernetes-csiæ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#kubernetes-csiæ¨¡å‹" aria-hidden="true">#</a> Kubernetes CSIæ¨¡å‹ï¼Ÿ</h3><p>Kubernetes CSIæ˜¯Kubernetesæ¨å‡ºä¸å®¹å™¨å¯¹æ¥çš„å­˜å‚¨æ¥å£æ ‡å‡†ï¼Œå­˜å‚¨æä¾›æ–¹åªéœ€è¦åŸºäºæ ‡å‡†æ¥å£è¿›è¡Œå­˜å‚¨æ’ä»¶çš„å®ç°ï¼Œå°±èƒ½ä½¿ç”¨Kubernetesçš„åŸç”Ÿå­˜å‚¨æœºåˆ¶ä¸ºå®¹å™¨æä¾›å­˜å‚¨æœåŠ¡ã€‚CSIä½¿å¾—å­˜å‚¨æä¾›æ–¹çš„ä»£ç èƒ½å’ŒKubernetesä»£ç å½»åº•è§£è€¦ï¼Œéƒ¨ç½²ä¹Ÿä¸Kubernetesæ ¸å¿ƒç»„ä»¶åˆ†ç¦»ï¼Œæ˜¾ç„¶ï¼Œå­˜å‚¨æ’ä»¶çš„å¼€å‘ç”±æä¾›æ–¹ è‡ªè¡Œç»´æŠ¤ï¼Œå°±èƒ½ä¸ºKubernetesç”¨æˆ·æä¾›æ›´å¤šçš„å­˜å‚¨åŠŸèƒ½ï¼Œä¹Ÿæ›´åŠ å®‰å…¨å¯é ã€‚ CSIåŒ…æ‹¬CSI Controllerå’ŒCSI Nodeï¼š CSI Controllerçš„ä¸»è¦åŠŸèƒ½æ˜¯æä¾›å­˜å‚¨æœåŠ¡è§†è§’å¯¹å­˜å‚¨èµ„æºå’Œå­˜å‚¨å·è¿›è¡Œç®¡ç†å’Œæ“ä½œã€‚CSI Nodeçš„ä¸»è¦åŠŸèƒ½æ˜¯å¯¹ä¸»æœº(Nodeï¼‰ä¸Šçš„Volumeè¿›è¡Œç®¡ç†å’Œæ“ä½œã€‚</p><h3 id="kubernetes-workerèŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#kubernetes-workerèŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„è¿‡ç¨‹" aria-hidden="true">#</a> Kubernetes WorkerèŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„è¿‡ç¨‹ï¼Ÿ</h3><p>é€šå¸¸éœ€è¦å¯¹WorkerèŠ‚ç‚¹è¿›è¡Œæ‰©å®¹ï¼Œä»è€Œå°†åº”ç”¨ç³»ç»Ÿè¿›è¡Œæ°´å¹³æ‰©å±•ã€‚ä¸»è¦è¿‡ç¨‹å¦‚ä¸‹ï¼š 1ã€åœ¨è¯¥Nodeä¸Šå®‰è£…Dockerã€kubeletå’Œkube-proxyæœåŠ¡ï¼› 2ã€ç„¶åé…ç½®kubeletå’Œkubeproxyçš„å¯åŠ¨å‚æ•°ï¼Œå°†Master URLæŒ‡å®šä¸ºå½“å‰Kubernetesé›†ç¾¤Master çš„åœ°å€ï¼Œæœ€åå¯åŠ¨è¿™äº›æœåŠ¡ï¼› 3ã€é€šè¿‡kubeleté»˜è®¤çš„è‡ªåŠ¨æ³¨å†Œæœºåˆ¶ï¼Œæ–°çš„Workerå°†ä¼šè‡ªåŠ¨åŠ å…¥ç°æœ‰çš„Kubernetesé›†ç¾¤ä¸­ï¼› 4ã€Kubernetes Masteråœ¨æ¥å—äº†æ–°Workerçš„æ³¨å†Œä¹‹åï¼Œä¼šè‡ªåŠ¨å°†å…¶çº³å…¥å½“å‰é›†ç¾¤çš„è°ƒåº¦èŒƒå›´ã€‚</p><h3 id="kubernetes-podå¦‚ä½•å®ç°å¯¹èŠ‚ç‚¹çš„èµ„æºæ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#kubernetes-podå¦‚ä½•å®ç°å¯¹èŠ‚ç‚¹çš„èµ„æºæ§åˆ¶" aria-hidden="true">#</a> Kubernetes Podå¦‚ä½•å®ç°å¯¹èŠ‚ç‚¹çš„èµ„æºæ§åˆ¶ï¼Ÿ</h3><p>Kubernetesé›†ç¾¤é‡Œçš„èŠ‚ç‚¹æä¾›çš„èµ„æºä¸»è¦æ˜¯è®¡ç®—èµ„æºï¼Œè®¡ç®—èµ„æºæ˜¯å¯è®¡é‡çš„èƒ½è¢«ç”³è¯·ã€åˆ†é…å’Œä½¿ç”¨çš„åŸºç¡€èµ„æºã€‚å½“å‰Kubernetesé›†ç¾¤ä¸­çš„è®¡ç®—èµ„æºä¸»è¦åŒ…æ‹¬CPUã€GPUåŠMemoryã€‚CPUä¸Memoryæ˜¯è¢«Pod ä½¿ç”¨çš„ï¼Œå› æ­¤åœ¨é…ç½®Podæ—¶å¯ä»¥é€šè¿‡å‚æ•°CPU RequeståŠMemory Requestä¸ºå…¶ä¸­çš„æ¯ä¸ªå®¹å™¨æŒ‡å®šæ‰€éœ€ä½¿ç”¨çš„CPUä¸Memoryé‡ï¼ŒKubernetesä¼šæ ¹æ®Requestçš„å€¼å»æŸ¥æ‰¾æœ‰è¶³å¤Ÿèµ„æºçš„Nodeæ¥è°ƒåº¦æ­¤Podã€‚ é€šå¸¸ï¼Œä¸€ä¸ªç¨‹åºæ‰€ä½¿ç”¨çš„CPUä¸Memoryæ˜¯ä¸€ä¸ªåŠ¨æ€çš„é‡ï¼Œç¡®åˆ‡åœ°è¯´ï¼Œæ˜¯ä¸€ä¸ªèŒƒå›´ï¼Œè·Ÿå®ƒçš„è´Ÿè½½å¯†åˆ‡ç›¸å…³ï¼šè´Ÿè½½å¢åŠ æ—¶ï¼ŒCPUå’ŒMemoryçš„ä½¿ç”¨é‡ä¹Ÿä¼šå¢åŠ ã€‚</p><h3 id="kubernetes-requestså’Œlimitså¦‚ä½•å½±å“podçš„è°ƒåº¦" tabindex="-1"><a class="header-anchor" href="#kubernetes-requestså’Œlimitså¦‚ä½•å½±å“podçš„è°ƒåº¦" aria-hidden="true">#</a> Kubernetes Requestså’ŒLimitså¦‚ä½•å½±å“Podçš„è°ƒåº¦ï¼Ÿ</h3><p>å½“ä¸€ä¸ªPodåˆ›å»ºæˆåŠŸæ—¶ï¼ŒKubernetesè°ƒåº¦å™¨(Schedulerï¼‰ä¼šä¸ºè¯¥Podé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹æ¥æ‰§è¡Œã€‚å¯¹äºæ¯ç§ è®¡ç®—èµ„æº(CPUå’ŒMemoryï¼‰è€Œè¨€ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªèƒ½ç”¨äºè¿è¡ŒPodçš„æœ€å¤§å®¹é‡å€¼ã€‚è°ƒåº¦å™¨åœ¨è°ƒåº¦ æ—¶ï¼Œé¦–å…ˆè¦ç¡®ä¿è°ƒåº¦åè¯¥èŠ‚ç‚¹ä¸Šæ‰€æœ‰Podçš„CPUå’Œå†…å­˜çš„Requestsæ€»å’Œï¼Œä¸è¶…è¿‡è¯¥èŠ‚ç‚¹èƒ½æä¾›ç»™Podä½¿ ç”¨çš„CPUå’ŒMemoryçš„æœ€å¤§å®¹é‡å€¼ã€‚</p><h3 id="kubernetes-metric-service" tabindex="-1"><a class="header-anchor" href="#kubernetes-metric-service" aria-hidden="true">#</a> Kubernetes Metric Serviceï¼Ÿ</h3><p>åœ¨Kubernetesä»1.10ç‰ˆæœ¬åé‡‡ç”¨Metrics Serverä½œä¸ºé»˜è®¤çš„æ€§èƒ½æ•°æ®é‡‡é›†å’Œç›‘æ§ï¼Œä¸»è¦ç”¨äºæä¾›æ ¸å¿ƒæŒ‡æ ‡(Core Metricsï¼‰ï¼ŒåŒ…æ‹¬Nodeã€Podçš„CPUå’Œå†…å­˜ä½¿ç”¨æŒ‡æ ‡ã€‚ å¯¹å…¶ä»–è‡ªå®šä¹‰æŒ‡æ ‡(Custom Metricsï¼‰çš„ç›‘æ§åˆ™ç”±Prometheusç­‰ç»„ä»¶æ¥å®Œæˆã€‚</p><h3 id="kubernetesä¸­-å¦‚ä½•ä½¿ç”¨efkå®ç°æ—¥å¿—çš„ç»Ÿä¸€ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#kubernetesä¸­-å¦‚ä½•ä½¿ç”¨efkå®ç°æ—¥å¿—çš„ç»Ÿä¸€ç®¡ç†" aria-hidden="true">#</a> Kubernetesä¸­ï¼Œå¦‚ä½•ä½¿ç”¨EFKå®ç°æ—¥å¿—çš„ç»Ÿä¸€ç®¡ç†ï¼Ÿ</h3><p>åœ¨Kubernetesé›†ç¾¤ç¯å¢ƒä¸­ï¼Œé€šå¸¸ä¸€ä¸ªå®Œæ•´çš„åº”ç”¨æˆ–æœåŠ¡æ¶‰åŠç»„ä»¶è¿‡å¤šï¼Œå»ºè®®å¯¹æ—¥å¿—ç³»ç»Ÿè¿›è¡Œé›†ä¸­åŒ–ç®¡ç†ï¼Œé€šå¸¸é‡‡ç”¨EFKå®ç°ã€‚ EFKæ˜¯ Elasticsearchã€Fluentd å’Œ Kibana çš„ç»„åˆï¼Œå…¶å„ç»„ä»¶åŠŸèƒ½å¦‚ä¸‹ï¼š Elasticsearchï¼šæ˜¯ä¸€ä¸ªæœç´¢å¼•æ“ï¼Œè´Ÿè´£å­˜å‚¨æ—¥å¿—å¹¶æä¾›æŸ¥è¯¢æ¥å£ï¼› Fluentdï¼šè´Ÿè´£ä» Kubernetes æœé›†æ—¥å¿—ï¼Œæ¯ä¸ªnodeèŠ‚ç‚¹ä¸Šé¢çš„fluentdç›‘æ§å¹¶æ”¶é›†è¯¥èŠ‚ç‚¹ä¸Šé¢çš„ç³»ç»Ÿæ—¥å¿—ï¼Œå¹¶å°†å¤„ç†è¿‡åçš„æ—¥å¿—ä¿¡æ¯å‘é€ç»™Elasticsearchï¼› Kibanaï¼šæä¾›äº†ä¸€ä¸ª Web GUIï¼Œç”¨æˆ·å¯ä»¥æµè§ˆå’Œæœç´¢å­˜å‚¨åœ¨ Elasticsearch ä¸­çš„æ—¥å¿—ã€‚ é€šè¿‡åœ¨æ¯å°nodeä¸Šéƒ¨ç½²ä¸€ä¸ªä»¥DaemonSetæ–¹å¼è¿è¡Œçš„fluentdæ¥æ”¶é›†æ¯å°nodeä¸Šçš„æ—¥å¿—ã€‚Fluentdå°† dockeræ—¥å¿—ç›®å½•/var/lib/docker/containerså’Œ/var/logç›®å½•æŒ‚è½½åˆ°Podä¸­ï¼Œç„¶åPodä¼šåœ¨nodeèŠ‚ç‚¹ çš„/var/log/podsç›®å½•ä¸­åˆ›å»ºæ–°çš„ç›®å½•ï¼Œå¯ä»¥åŒºåˆ«ä¸åŒçš„å®¹å™¨æ—¥å¿—è¾“å‡ºï¼Œè¯¥ç›®å½•ä¸‹æœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶é“¾æ¥åˆ°/var/lib/docker/contianersç›®å½•ä¸‹çš„å®¹å™¨æ—¥å¿—è¾“å‡ºã€‚</p><h3 id="kuberneteså¦‚ä½•è¿›è¡Œä¼˜é›…çš„èŠ‚ç‚¹å…³æœºç»´æŠ¤" tabindex="-1"><a class="header-anchor" href="#kuberneteså¦‚ä½•è¿›è¡Œä¼˜é›…çš„èŠ‚ç‚¹å…³æœºç»´æŠ¤" aria-hidden="true">#</a> Kuberneteså¦‚ä½•è¿›è¡Œä¼˜é›…çš„èŠ‚ç‚¹å…³æœºç»´æŠ¤ï¼Ÿ</h3><p>ç”±äºKubernetesèŠ‚ç‚¹è¿è¡Œå¤§é‡Podï¼Œå› æ­¤åœ¨è¿›è¡Œå…³æœºç»´æŠ¤ä¹‹å‰ï¼Œå»ºè®®å…ˆä½¿ç”¨kubectl drainå°†è¯¥èŠ‚ç‚¹çš„Podè¿›è¡Œé©±é€ï¼Œç„¶åè¿›è¡Œå…³æœºç»´æŠ¤ã€‚</p><h3 id="kubernetesé›†ç¾¤è”é‚¦" tabindex="-1"><a class="header-anchor" href="#kubernetesé›†ç¾¤è”é‚¦" aria-hidden="true">#</a> Kubernetesé›†ç¾¤è”é‚¦ï¼Ÿ</h3><p>Kubernetesé›†ç¾¤è”é‚¦å¯ä»¥å°†å¤šä¸ªKubernetesé›†ç¾¤ä½œä¸ºä¸€ä¸ªé›†ç¾¤è¿›è¡Œç®¡ç†ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒ/ äº‘ä¸­åˆ›å»ºå¤šä¸ªKubernetesé›†ç¾¤ï¼Œå¹¶ä½¿ç”¨é›†ç¾¤è”é‚¦åœ¨ä¸€ä¸ªåœ°æ–¹æ§åˆ¶/ç®¡ç†æ‰€æœ‰é›†ç¾¤ã€‚</p><h3 id="helmåŠå…¶ä¼˜åŠ¿" tabindex="-1"><a class="header-anchor" href="#helmåŠå…¶ä¼˜åŠ¿" aria-hidden="true">#</a> HelmåŠå…¶ä¼˜åŠ¿ï¼Ÿ</h3><p>Helm æ˜¯ Kubernetes çš„è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ã€‚ç±»ä¼¼ Ubuntu ä¸­ä½¿ç”¨çš„aptã€Centosä¸­ä½¿ç”¨çš„yum æˆ–è€… Pythonä¸­çš„ pip ä¸€æ ·ã€‚ Helmèƒ½å¤Ÿå°†ä¸€ç»„K8Sèµ„æºæ‰“åŒ…ç»Ÿä¸€ç®¡ç†, æ˜¯æŸ¥æ‰¾ã€å…±äº«å’Œä½¿ç”¨ä¸ºKubernetesæ„å»ºçš„è½¯ä»¶çš„æœ€ä½³æ–¹å¼ã€‚ Helmä¸­é€šå¸¸æ¯ä¸ªåŒ…ç§°ä¸ºä¸€ä¸ªChartï¼Œä¸€ä¸ªChartæ˜¯ä¸€ä¸ªç›®å½•(ä¸€èˆ¬æƒ…å†µä¸‹ä¼šå°†ç›®å½•è¿›è¡Œæ‰“åŒ…å‹ç¼©ï¼Œå½¢æˆname-version.tgzæ ¼å¼çš„å•ä¸€æ–‡ä»¶ï¼Œæ–¹ä¾¿ä¼ è¾“å’Œå­˜å‚¨ï¼‰ã€‚ Helmä¼˜åŠ¿ åœ¨ Kubernetesä¸­éƒ¨ç½²ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„åº”ç”¨ï¼Œéœ€è¦æ¶‰åŠåˆ°å¾ˆå¤šçš„ Kubernetes èµ„æºçš„å…±åŒåä½œã€‚ä½¿ç”¨ helmåˆ™å…·æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š ç»Ÿä¸€ç®¡ç†ã€é…ç½®å’Œæ›´æ–°è¿™äº›åˆ†æ•£çš„ k8s çš„åº”ç”¨èµ„æºæ–‡ä»¶ï¼› åˆ†å‘å’Œå¤ç”¨ä¸€å¥—åº”ç”¨æ¨¡æ¿ï¼› å°†åº”ç”¨çš„ä¸€ç³»åˆ—èµ„æºå½“åšä¸€ä¸ªè½¯ä»¶åŒ…ç®¡ç†ã€‚ å¯¹äºåº”ç”¨å‘å¸ƒè€…è€Œè¨€ï¼Œå¯ä»¥é€šè¿‡ Helm æ‰“åŒ…åº”ç”¨ã€ç®¡ç†åº”ç”¨ä¾èµ–å…³ç³»ã€ç®¡ç†åº”ç”¨ç‰ˆæœ¬å¹¶å‘å¸ƒåº”ç”¨åˆ°è½¯ä»¶ä»“åº“ã€‚ å¯¹äºä½¿ç”¨è€…è€Œè¨€ï¼Œä½¿ç”¨ Helm åä¸ç”¨éœ€è¦ç¼–å†™å¤æ‚çš„åº”ç”¨éƒ¨ç½²æ–‡ä»¶ï¼Œå¯ä»¥ä»¥ç®€å•çš„æ–¹å¼åœ¨ Kubernetes ä¸ŠæŸ¥æ‰¾ã€å®‰è£…ã€å‡çº§ã€å›æ»šã€å¸è½½åº”ç”¨ç¨‹åºã€‚</p></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><!----><!----></div></footer><!----><div class="waline-wrapper" id="comment" darkmode="false" style="display:block;"><div data-waline provider="Waline" comment="true"><!--v-if--><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item2"><!--[--><div class="wl-header-item"><label for="wl-nick">æ˜µç§°</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">é‚®ç®±</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="è¯·ç•™è¨€ã€‚(å¡«å†™é‚®ç®±å¯åœ¨è¢«å›å¤æ—¶æ”¶åˆ°é‚®ä»¶æé†’)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>é¢„è§ˆ:</h4><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noopener noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button type="button" class="wl-action" title="è¡¨æƒ…" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button type="button" class="wl-action" title="è¡¨æƒ…åŒ…"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="ä¸Šä¼ å›¾ç‰‡"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button type="button" class="wl-action" title="é¢„è§ˆ"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-text-number">0 <!--v-if--> Â å­—</div><button type="button" class="wl-btn">ç™»å½•</button><button type="submit" class="primary wl-btn" title="Cmd|Ctrl + Enter"><!--[-->æäº¤<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="æœç´¢è¡¨æƒ…åŒ…"><div class="wl-gallery" style="gap:6px;"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> è¯„è®º</div><ul class="wl-sort"><!--[--><li class="active">æŒ‰æ­£åº</li><li class="">æŒ‰å€’åº</li><li class="">æŒ‰çƒ­åº¦</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noopener noreferrer"> Waline </a> v2.14.7</div></div></div><!----><!--]--></main><!--]--><!----></div><!--]--><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-8628a663.js" defer></script>
  </body>
</html>
